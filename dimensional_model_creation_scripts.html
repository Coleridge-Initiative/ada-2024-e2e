<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dimensional Model Scripts â€“ Enrollment to Employment Applied Data Analytics 2024 Class</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./installing_packages.html" rel="next">
<link href="./06_Presentation_prep.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 3,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dimensional_model_creation_scripts.html">Dimensional Model Scripts</a></li><li class="breadcrumb-item"><a href="./dimensional_model_creation_scripts.html"><span class="chapter-title">Dimensional Model Scripts</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Enrollment to Employment Applied Data Analytics 2024 Class</a> 
        <div class="sidebar-tools-main">
    <a href="https://coleridge-initiative.github.io/ada-2024-e2e/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_EDA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Exploratory Data Analysis (EDA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_data_model_motivation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Data Model Motivation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_cross_section.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cross-Sectional Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_longitudinal_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Longitudinal Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_measurement.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Measuring Workforce Outcomes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Presentation_prep.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Presentation Preparation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Dimensional Model Scripts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dimensional_model_creation_scripts.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Dimensional Model Scripts</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Supplemental</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installing_packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Installing startup packages</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ddl-creating-and-permissioning-tables-scripts" id="toc-ddl-creating-and-permissioning-tables-scripts" class="nav-link active" data-scroll-target="#ddl-creating-and-permissioning-tables-scripts">01 DDL (Creating and Permissioning Tables) Scripts</a></li>
  <li><a href="#load-scripts" id="toc-load-scripts" class="nav-link" data-scroll-target="#load-scripts">02 Load Scripts</a>
  <ul class="collapse">
  <li><a href="#fact-person-outcome-tables" id="toc-fact-person-outcome-tables" class="nav-link" data-scroll-target="#fact-person-outcome-tables">FACT Person Outcome Tables</a></li>
  <li><a href="#fact-person-program-observation-quarter-tables" id="toc-fact-person-program-observation-quarter-tables" class="nav-link" data-scroll-target="#fact-person-program-observation-quarter-tables">FACT Person Program Observation Quarter Tables</a></li>
  <li><a href="#fact-person-program-participation-tables" id="toc-fact-person-program-participation-tables" class="nav-link" data-scroll-target="#fact-person-program-participation-tables">FACT Person Program Participation Tables</a></li>
  <li><a href="#fact-person-quarterly-program-enrollment-tables" id="toc-fact-person-quarterly-program-enrollment-tables" class="nav-link" data-scroll-target="#fact-person-quarterly-program-enrollment-tables">FACT Person Quarterly Program Enrollment Tables</a></li>
  <li><a href="#fact-person-ui-wage-table" id="toc-fact-person-ui-wage-table" class="nav-link" data-scroll-target="#fact-person-ui-wage-table">FACT Person UI Wage Table</a></li>
  <li><a href="#dimension-tables" id="toc-dimension-tables" class="nav-link" data-scroll-target="#dimension-tables">Dimension Tables</a></li>
  <li><a href="#coleridge-initiative-adjustments" id="toc-coleridge-initiative-adjustments" class="nav-link" data-scroll-target="#coleridge-initiative-adjustments">Coleridge Initiative Adjustments</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dimensional_model_creation_scripts.html">Dimensional Model Scripts</a></li><li class="breadcrumb-item"><a href="./dimensional_model_creation_scripts.html"><span class="chapter-title">Dimensional Model Scripts</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Dimensional Model Scripts</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
#HIDE THIS CHUNK FROM KNITTED OUTPUT
h2 {margin: 2m 0 !important;} 

details {
  margin-left: 4em;
  margin-bottom: .5rem;
}

summary { 
  margin-left: -2em;
}
</style>
</div>
<section id="ddl-creating-and-permissioning-tables-scripts" class="level2">
<h2 class="anchored" data-anchor-id="ddl-creating-and-permissioning-tables-scripts">01 DDL (Creating and Permissioning Tables) Scripts</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">/* DBMS name:      Amazon Redshift Database                     */</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">/* Created on:     9/7/2023 12:14:46 PM                         */</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> FACT_Person_Program_Observation_Quarter;</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> FACT_Person_Program_Outcome;</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> FACT_Person_Program_Participation;</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> FACT_Person_UI_Wage;</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> FACT_Person_Quarterly_Program_Enrollment;</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_CIP;</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_County;</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_Intake_Characteristics;</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_Person;</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_Program;</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_State;</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">table</span> DIM_Year_Quarter;</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_CIP                                               */</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_CIP (</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>   CIP_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>   Classification_Code <span class="dt">CHAR</span>(<span class="dv">7</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>   Classification_Name <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>   Category_Name <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>   Series_Name <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>   Series_Short_Name <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>   Major_Group_Code <span class="dt">CHAR</span>(<span class="dv">2</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>   Major_Group_Name <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_CIP_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (CIP_Key),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Classification_Code)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_County                                            */</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_County (</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>   County_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>   County_FIPS_Code <span class="dt">CHAR</span>(<span class="dv">5</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>   County_Name <span class="dt">VARCHAR</span>(<span class="dv">150</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>   Rural_Urban_Continuum <span class="dt">VARCHAR</span>(<span class="dv">300</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>   Local_Workforce_Development_Area <span class="dt">VARCHAR</span>(<span class="dv">30</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_COUNTY_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (County_Key),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (County_FIPS_Code)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_Intake_Characteristics                            */</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_Intake_Characteristics (</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>   Intake_Characteristics_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>   Highest_School_Grade_Completed_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">2</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>   Highest_Education_Level_Completed_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>   School_Status_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>   Employment_Status_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>   Long_Term_Unemployment_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>   Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>   Foster_Care_Youth_Status_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>   Homeless_or_Runaway_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>   Ex_Offender_Status_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>   Low_Income_Status_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>   English_Language_Learner_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>   Low_Levels_of_Literacy_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>   Cultural_Barriers_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>   Single_Parent_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>   Displaced_Homemaker_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_INTAKE_CHARACTERISTICS_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Intake_Characteristics_Key)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_Person                                            */</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_Person (</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>   Person_UID <span class="dt">CHAR</span>(<span class="dv">64</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>   Date_of_Birth <span class="dt">DATE</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>   Gender <span class="dt">VARCHAR</span>(<span class="dv">10</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>   Ethnicity_American_Indian_or_Alaska_Native <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Asian <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Black_or_African_American <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Hispanic_or_Latino <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>   Ethnicity_White <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Other <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_PERSON_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Key),</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_UID)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_Program                                           */</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_Program (</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>   Program_Name <span class="dt">VARCHAR</span>(<span class="dv">75</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_PROGRAM_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Program_Key),</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Program_Name)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_State                                             */</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_State (</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>   State_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>   State_FIPS_Code <span class="dt">CHAR</span>(<span class="dv">2</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>   State_Abbreviation <span class="dt">CHAR</span>(<span class="dv">2</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>   State_Name <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_STATE_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (State_Key),</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (State_FIPS_Code),</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (State_Abbreviation)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: DIM_Year_Quarter                                      */</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> DIM_Year_Quarter (</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>   Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>   Calendar_Year <span class="dt">CHAR</span>(<span class="dv">4</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>   Calendar_Quarter <span class="dt">CHAR</span>(<span class="dv">1</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>   Quarter_Start_Date <span class="dt">DATE</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>   Quarter_End_Date <span class="dt">DATE</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_YEAR_QUARTER_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Year_Quarter_Key),</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Calendar_Year, Calendar_Quarter)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: FACT_Person_Program_Observation_Quarter               */</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> FACT_Person_Program_Observation_Quarter (</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>   Person_Program_Observation_Quarter_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>   Observation_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>   County_of_Residence_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>   State_of_Residence_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>   CIP_Classification_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>   Enrolled_Entire_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>   Enrolled_First_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>   Enrolled_Second_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>   Enrolled_Third_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>   Gross_Monthly_Income <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>),</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>   Net_Monthly_Income <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>),</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Career_Service <span class="dt">DATE</span>,</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>   Received_Training <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>   Eligible_Training_Provider_Name <span class="dt">VARCHAR</span>(<span class="dv">75</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>   Eligible_Training_Provider_Program_of_Study <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_1 <span class="dt">DATE</span>,</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_1 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_2 <span class="dt">DATE</span>,</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_2 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_3 <span class="dt">DATE</span>,</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_3 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>   Participated_in_Postsecondary_Education_During_Program_Participation <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>   Received_Training_from_Private_Section_Operated_Program <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>   Enrolled_in_Secondary_Education_Program <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>   Date_Enrolled_in_Post_Exit_Education_or_Training_Program <span class="dt">DATE</span>,</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>   Youth_2nd_Quarter_Placement <span class="dt">VARCHAR</span>(<span class="dv">50</span>),</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>   Youth_4th_Quarter_Placement <span class="dt">VARCHAR</span>(<span class="dv">50</span>),</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>   Other_Reason_for_Exit <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>   Migrant_and_Seasonal_Farmworker_Status <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>   Individual_with_a_Disability <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>   Zip_Code_of_Residence <span class="dt">CHAR</span>(<span class="dv">5</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Student_Level <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Enrollment_Status <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Tuition_Status <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FACT_PERSON_PROGRAM_OBSERVATION_QUARTER_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Program_Observation_Quarter_ID),</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Program_Key, Observation_Year_Quarter_Key),</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Person (Person_Key),</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_PROGRAM <span class="kw">foreign</span> <span class="kw">key</span> (Program_Key) </span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Program (Program_Key),</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_YEAR_QUARTER <span class="kw">foreign</span> <span class="kw">key</span> (Observation_Year_Quarter_Key) </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key),</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_COUNTY <span class="kw">foreign</span> <span class="kw">key</span> (County_of_Residence_Key) </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_County (County_Key),</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_STATE <span class="kw">foreign</span> <span class="kw">key</span> (State_of_Residence_Key) </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_State (State_Key),</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OBSERVATION_QUARTER__DIM_CIP <span class="kw">foreign</span> <span class="kw">key</span> (CIP_Classification_Key) </span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_CIP (CIP_Key)</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: FACT_Person_Program_Outcome                           */</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> FACT_Person_Program_Outcome (</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>   Person_Program_Outcomes_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>   Exit_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>   Employed_in_1st_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">30</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>   Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>   Earnings_1st_Quarter_After_Exit_Quarter <span class="dt">DECIMAL</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>   Employed_in_2nd_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">30</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>   Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>   Earnings_2nd_Quarter_After_Exit_Quarter <span class="dt">DECIMAL</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>   Employed_in_3rd_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">30</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>   Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>   Earnings_3rd_Quarter_After_Exit_Quarter <span class="dt">DECIMAL</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>   Employed_in_4th_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">30</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>   Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>   Earnings_4th_Quarter_After_Exit_Quarter <span class="dt">DECIMAL</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>   Employment_Related_to_Training <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>   Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>   Type_of_Recognized_Credential_1 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>   Type_of_Recognized_Credential_2 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>   Type_of_Recognized_Credential_3 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>   Date_Attained_Recognized_Credential_1 <span class="dt">DATE</span>,</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>   Date_Attained_Recognized_Credential_2 <span class="dt">DATE</span>,</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>   Date_Attained_Recognized_Credential_3 <span class="dt">DATE</span>,</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level <span class="dt">DATE</span>,</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript <span class="dt">DATE</span>,</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript <span class="dt">DATE</span>,</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone <span class="dt">DATE</span>,</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression <span class="dt">DATE</span>,</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>   Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment <span class="dt">DATE</span>,</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>   Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment <span class="dt">DATE</span>,</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>   Date_Attained_Graduate_or_Post_Graduate_Degree <span class="dt">DATE</span>,</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FACT_PERSON_PROGRAM_OUTCOME_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Program_Outcomes_ID),</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Program_Key, Exit_Year_Quarter_Key),</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OUTCOME__DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Person (Person_Key),</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OUTCOME__DIM_PROGRAM <span class="kw">foreign</span> <span class="kw">key</span> (Program_Key) </span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Program (Program_Key),</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_OUTCOME__DIM_YEAR_QUARTER <span class="kw">foreign</span> <span class="kw">key</span> (Exit_Year_Quarter_Key) </span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key)</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: FACT_Person_Program_Participation                     */</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> FACT_Person_Program_Participation (</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>   Person_Program_Participation_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>   Intake_Characteristics_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>   Entry_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>   Exit_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>   County_of_Residence_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>   State_of_Residence_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>   CIP_Classification_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>   Gross_Monthly_Income <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>),</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>   Net_Monthly_Income <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>),</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>   Date_of_Most_Recent_Career_Service <span class="dt">DATE</span>,</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>   Received_Training <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>   Eligible_Training_Provider_Name <span class="dt">VARCHAR</span>(<span class="dv">75</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>   Eligible_Training_Provider_Program_of_Study <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_1 <span class="dt">DATE</span>,</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_1 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_2 <span class="dt">DATE</span>,</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_2 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>   Date_Entered_Training_3 <span class="dt">DATE</span>,</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>   Type_of_Training_Service_3 <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>   Participated_in_Postsecondary_Education_During_Program_Participation <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>   Received_Training_from_Private_Section_Operated_Program <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>   Enrolled_in_Secondary_Education_Program <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>   Date_Enrolled_in_Post_Exit_Education_or_Training_Program <span class="dt">DATE</span>,</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>   Youth_2nd_Quarter_Placement <span class="dt">VARCHAR</span>(<span class="dv">50</span>),</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>   Youth_4th_Quarter_Placement <span class="dt">VARCHAR</span>(<span class="dv">50</span>),</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>   Incarcerated_at_Program_Entry <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>   Date_Released_from_Incarceration <span class="dt">DATE</span>,</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>   Other_Reason_for_Exit <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>   Migrant_and_Seasonal_Farmworker_Status <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>   Individual_with_a_Disability <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>   Zip_Code_of_Residence <span class="dt">CHAR</span>(<span class="dv">5</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Student_Level <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Enrollment_Status <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>   Higher_Education_Tuition_Status <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FACT_PERSON_PROGRAM_PARTICIPATION_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Program_Participation_ID),</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key),</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_PROGRAM <span class="kw">foreign</span> <span class="kw">key</span> (Program_Key) </span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Program (Program_Key),</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_YEAR_QUARTER__ENTRY_YEAR <span class="kw">foreign</span> <span class="kw">key</span> (Entry_Year_Quarter_Key) </span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key),</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Person (Person_Key),</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_YEAR_QUARTER__EXIT_YEAR <span class="kw">foreign</span> <span class="kw">key</span> (Exit_Year_Quarter_Key) </span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key),</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_INTAKE_CHARACTERISTICS <span class="kw">foreign</span> <span class="kw">key</span> (Intake_Characteristics_Key) </span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Intake_Characteristics (Intake_Characteristics_Key),</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM_PARTICIPATION__DIM_COUNTY <span class="kw">foreign</span> <span class="kw">key</span> (County_of_Residence_Key) </span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_County (County_Key),</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM__FACT_PERSON_PROGRAM_PARTICIPATION__DIM_CIP_DIM_CIP <span class="kw">foreign</span> <span class="kw">key</span> (CIP_Classification_Key) </span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_CIP (CIP_Key),</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_PROGRAM__FACT_PERSON_PROGRAM_PARTICIPATION__DIM_STATE_DIM_STATE <span class="kw">foreign</span> <span class="kw">key</span> (State_of_Residence_Key) </span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_State (State_Key)</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: FACT_Person_UI_Wage                                   */</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> FACT_Person_UI_Wage (</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>   Person_UI_Wage_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>   Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>   UI_Quarterly_Wages <span class="dt">DECIMAL</span>(<span class="dv">10</span>,<span class="dv">0</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FACT_PERSON_UI_WAGE_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_UI_Wage_ID),</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Year_Quarter_Key),</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_UI_WAGE__DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Person (Person_Key),</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_UI_WAGE__DIM_YEAR_QUARTER <span class="kw">foreign</span> <span class="kw">key</span> (Year_Quarter_Key) </span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key)</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a><span class="co">/* Table: FACT_Person_Quarterly_Program_Enrollment              */</span></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a><span class="co">/*==============================================================*/</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> FACT_Person_Quarterly_Program_Enrollment (</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>   Person_Quarterly_Program_Enrollment_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>   Enrollment_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>   Enrolled_Entire_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>   Enrolled_First_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>   Enrolled_Second_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>   Enrolled_Third_Month_of_Quarter <span class="dt">VARCHAR</span>(<span class="dv">3</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> PK_FACT_Person_Quarterly_Program_Enrollment <span class="kw">primary</span> <span class="kw">key</span> (Person_Quarterly_Program_Enrollment_ID),</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Program_Key, Enrollment_Quarter_Key),</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_QUARTERLY_PROGRAM_ENROLLMENT_DIM_PROGRAM <span class="kw">foreign</span> <span class="kw">key</span> (Program_Key) </span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Program (Program_Key),</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_QUARTERLY_PROGRAM_ENROLLMENT_DIM_YEAR_QUARTER <span class="kw">foreign</span> <span class="kw">key</span> (Enrollment_Quarter_Key) </span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Year_Quarter (Year_Quarter_Key),</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_QUARTERLY_PROGRAM_ENROLLMENT_DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> DIM_Person (Person_Key)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Person <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Person <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Program <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Program <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Intake_Characteristics <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Intake_Characteristics <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Year_Quarter <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_Year_Quarter <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_County <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> DIM_County <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Observation_Quarter <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Observation_Quarter <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Outcome <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Outcome <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Participation <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Program_Participation <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_UI_Wage <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_UI_Wage <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Quarterly_Program_Enrollment <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">INSERT</span> <span class="kw">ON</span> <span class="kw">TABLE</span> FACT_Person_Quarterly_Program_Enrollment <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-scripts" class="level2">
<h2 class="anchored" data-anchor-id="load-scripts">02 Load Scripts</h2>
<section id="fact-person-outcome-tables" class="level3">
<h3 class="anchored" data-anchor-id="fact-person-outcome-tables">FACT Person Outcome Tables</h3>
<section id="joint-pirl" class="level4">
<h4 class="anchored" data-anchor-id="joint-pirl">JOINT PIRL</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Adult Education (JOINT)" program.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.jointpirl_raw_data) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (Joint PIRL)</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (JOINT)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.jointpirl_raw_data</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ssn_valid_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adult-education" class="level4">
<h4 class="anchored" data-anchor-id="adult-education">Adult Education</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Adult Education (WIOA)" program.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Adult Education)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adult" class="level4">
<h4 class="anchored" data-anchor-id="adult">Adult</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Adult (WIOA)" program.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Adult)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.adult_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dislocated-worker" class="level4">
<h4 class="anchored" data-anchor-id="dislocated-worker">Dislocated Worker</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Dislocated Worker (WIOA)" program.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Dislocated Worker)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Dislocated Worker (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.dislocated_worker_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="job-corps" class="level4">
<h4 class="anchored" data-anchor-id="job-corps">Job Corps</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Job Corps (WIOA)" program.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Job Corps)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Job Corps (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.job_corps_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vocational-rehab" class="level4">
<h4 class="anchored" data-anchor-id="vocational-rehab">Vocational Rehab</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Vocational Rehabilitation (WIOA)" program.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Vocational Rehab)</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Vocational Rehabilitation (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.vocational_rehabilitation_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wagner-peyser" class="level4">
<h4 class="anchored" data-anchor-id="wagner-peyser">Wagner Peyser</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Wagner-Peyser Employment Service (WIOA)" program.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Wagner Peyser)</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Wagner-Peyser Employment Service (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.wagner_peyser_employment_service_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="youth-builder" class="level4">
<h4 class="anchored" data-anchor-id="youth-builder">Youth Builder</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "YouthBuild (WIOA)" program.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Youth Build)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'YouthBuild (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.youthbuild_wioa <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-199"><a href="#cb9-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb9-211"><a href="#cb9-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb9-212"><a href="#cb9-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb9-230"><a href="#cb9-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb9-231"><a href="#cb9-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb9-236"><a href="#cb9-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb9-237"><a href="#cb9-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="youth" class="level4">
<h4 class="anchored" data-anchor-id="youth">Youth</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Outcome table with data for the "Youth (WIOA)" program.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Outcome (PIRL - Youth)</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Outcome (Person_Key, Program_Key, Exit_Year_Quarter_Key, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                                         Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                         Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                                         Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                                         Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                                         Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                                         Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                                         Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                                         Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                                         Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, exit_date, Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>              Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>              Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>              Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>              Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>              Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>              Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>              Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>              Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>              Date_Attained_Graduate_or_Post_Graduate_Degree)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  social_security_number,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Youth (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>            date_of_program_exit_wioa,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_1st_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_1st_quarter_after_exit_quarter_wioa</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_1st_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_2nd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_2nd_quarter_after_exit_quarter_wioa</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_2nd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_3rd_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_3rd_quarter_after_exit_quarter_wioa</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_3rd_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> employed_in_4th_quarter_after_exit_quarter_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_employment_match_4th_quarter_after_exit_quarter_wioa</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'UI Wage Data'</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'Federal Employment Records (OPM, USPS)'</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'Military Employment Records (DOD)'</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Non UI verification'</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Information not yet available'</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'Not employed'</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(earnings_4th_quarter_after_exit_quarter_wioa, <span class="dv">0</span>),</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_related_to_training_2nd_quarter_after_exit_wioa</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> retention_with_the_same_employer_in_the_2nd_quarter_and_the_4th_quarter_wioa</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_wioa</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_2_wioa</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_recognized_credential_3_wioa</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Secondary School Diploma/or equivalency'</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">2</span> <span class="cf">THEN</span> <span class="st">'AA or AS Diploma/Degree'</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">3</span> <span class="cf">THEN</span> <span class="st">'BA or BS Diploma/Degree'</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">4</span> <span class="cf">THEN</span> <span class="st">'Occupational Licensure'</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">5</span> <span class="cf">THEN</span> <span class="st">'Occupational Certificate'</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">6</span> <span class="cf">THEN</span> <span class="st">'Occupational Certification'</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Other Recognized Diploma, Degree, or Certificate'</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="dv">0</span> <span class="cf">THEN</span> <span class="st">'No recognized credential'</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_2_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_recognized_credential_3_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_educational_functioning_level_efl_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_postsecondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_secondary_transcript_report_card_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_training_milestone_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_measurable_skill_gains_skills_progression_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_completed_during_program_participation_an_education_or_training_program_leading_to_a_recognized_credential_or_employment, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_attained_graduate_post_graduate_degree_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>))</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_exit_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youth_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>cteFactData</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>            pirl.Employed_in_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>            pirl.Earnings_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>            pirl.Employment_Related_to_Training,</span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>            pirl.Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter,</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_1,</span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_2,</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Recognized_Credential_3,</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_1,</span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_2,</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Recognized_Credential_3,</span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>        Employed_in_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_1st_Quarter_After_Exit_Quarter, Earnings_1st_Quarter_After_Exit_Quarter,</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>        Employed_in_2nd_Quarter_After_Exit_Quarter, Type_of_Employment_Match_2nd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>        Earnings_2nd_Quarter_After_Exit_Quarter, Employed_in_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>        Type_of_Employment_Match_3rd_Quarter_After_Exit_Quarter, Earnings_3rd_Quarter_After_Exit_Quarter,</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>        Employed_in_4th_Quarter_After_Exit_Quarter, Type_of_Employment_Match_4th_Quarter_After_Exit_Quarter,</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>        Earnings_4th_Quarter_After_Exit_Quarter, Employment_Related_to_Training,</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>        Retention_with_Same_Employer_2nd_Quarter_and_4th_Quarter, Type_of_Recognized_Credential_1,</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>        Type_of_Recognized_Credential_2, Type_of_Recognized_Credential_3, Date_Attained_Recognized_Credential_1,</span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Recognized_Credential_2, Date_Attained_Recognized_Credential_3,</span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Educational_Functional_Level,</span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Postsecondary_Transcript,</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Secondary_Transcript,</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Training_Milestone,</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Measurable_Skill_Gain_Skills_Progression,</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>        Date_Completed_an_Education_or_Training_Program_Leading_to_Credential_or_Employment,</span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>        Date_Attained_Graduate_or_Post_Graduate_Degree</span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fact-person-program-observation-quarter-tables" class="level3">
<h3 class="anchored" data-anchor-id="fact-person-program-observation-quarter-tables">FACT Person Program Observation Quarter Tables</h3>
<section id="higher-education" class="level4">
<h4 class="anchored" data-anchor-id="higher-education">Higher Education</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Higher Education" program.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Try to remove duplicated higher education records by grouping on ssn, entry quarter, and exit quarter and selecting</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">            the minium academic_year and miniumum term for each grouping.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The entry and exit quarters are calculated using academic_year and term.  Academic_year has to be adjusted to calendar year. </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each record found in step 1.</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteHigherEducation CTE.</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for each cteHigherEducation record.</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (Higher Education)</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteDeDuplicate (social_security_number, Observation_Year_Quarter_Key, academic_year, academic_term, qtr_first_month, qtr_second_month, qtr_third_month)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  se.ssn_id <span class="kw">AS</span> social_security_number,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>            obs_qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(se.academic_year),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(se.term) <span class="kw">AS</span> academic_term,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'3'</span>, <span class="st">'7'</span>) <span class="cf">THEN</span> <span class="st">'No'</span> <span class="cf">ELSE</span> <span class="st">'Yes'</span> <span class="cf">END</span>) <span class="kw">AS</span> first_month_qtr,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">3</span>)) <span class="kw">AS</span> second_month_qtr,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'4'</span>) <span class="cf">THEN</span> <span class="st">'No'</span> <span class="cf">ELSE</span> <span class="st">'Yes'</span> <span class="cf">END</span>) <span class="kw">AS</span> third_month_qtr</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhe.student_enrollment_table se</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter obs_qtr</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> obs_qtr.calendar_year <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(se.academic_year <span class="kw">AS</span> <span class="dt">INT</span>) <span class="op">-</span> <span class="dv">1</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">4</span>)) <span class="cf">ELSE</span> se.academic_year <span class="cf">END</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> obs_qtr.calendar_quarter <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'4'</span>) <span class="cf">THEN</span> <span class="st">'3'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="st">'4'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'2'</span>, <span class="st">'6'</span>) <span class="cf">THEN</span> <span class="st">'1'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'3'</span>, <span class="st">'7'</span>) <span class="cf">THEN</span> <span class="st">'2'</span> <span class="cf">END</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> se.academic_year <span class="op">&gt;=</span> <span class="st">'2011'</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.ssn_valid_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>, <span class="st">'5'</span>, <span class="st">'6'</span>, <span class="st">'7'</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> se.ssn_id, obs_qtr.Year_Quarter_Key</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>cteHigherEducation (social_security_number, program_name, Observation_Year_Quarter_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>                    Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, County_FIPS_Code, state_abbreviation, cip_code, cip_detail,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>                    Participated_in_Postsecondary_Education_During_Program_Participation, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>                    Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  cteDeDuplicate.social_security_number,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Higher Education'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.Observation_Year_Quarter_Key,</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> cteDeDuplicate.qtr_first_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteDeDuplicate.qtr_second_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteDeDuplicate.qtr_third_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.qtr_first_month <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.qtr_second_month <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.qtr_third_month <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(se.geo_county, <span class="st">''</span>) <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(se.geo_state, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(dfy.cip_code, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(dfy.cip_detail, <span class="st">''</span>) <span class="kw">AS</span> cip_detail,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">3</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">3</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(rsl.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(res.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(rts.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhe.student_enrollment_table se</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> cteDeDuplicate</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.ssn_id <span class="op">=</span> cteDeDuplicate.social_security_number</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.academic_year <span class="op">=</span> cteDeDuplicate.academic_year</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>        <span class="kw">and</span> se.term <span class="op">=</span> cteDeDuplicate.academic_term</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.degree_fice_year_Table dfy</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.fice_code <span class="op">=</span> dfy.fice_code</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.academic_year <span class="op">=</span> dfy.academic_year</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.major_1 <span class="op">=</span> dfy.degree_code</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.refenrollstatus res</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.enroll_status <span class="op">=</span> res.enrollstatusid</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.refstudentlevel rsl</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.student_level <span class="op">=</span> rsl.countryid     <span class="co">-- note: The name of the PK for this table is probably a typo (i.e. incorrect)</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.reftuitionstatus rts</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.tuition_status <span class="op">=</span> rts.tuitionstatusid</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> se.academic_year <span class="op">&gt;=</span> <span class="st">'2011'</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.ssn_valid_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>             Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter,</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation,  Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a> <span class="kw">AS</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a> (</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>     <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> he.social_security_number</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> he.program_name</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Observation Year Quarter Surrogate Key</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>            he.Observation_Year_Quarter_Key,</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> he.County_FIPS_Code</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> he.state_abbreviation</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> <span class="fu">CONCAT</span>(he.cip_code, <span class="fu">CONCAT</span>(<span class="fu">CAST</span>(<span class="st">'.'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)), he.cip_detail))</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_Entire_Quarter,</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_First_Month_of_Quarter,</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_Second_Month_of_Quarter,</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_Third_Month_of_Quarter,</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>            he.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Student_Level,</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Enrollment_Status,</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Tuition_Status</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteHigherEducation he</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Observation_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>        Enrolled_Entire_Quarter,</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status, </span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="joint-pirl-1" class="level4">
<h4 class="anchored" data-anchor-id="joint-pirl-1">Joint PIRL</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Adult Education (JOINT)" program.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.jointpirl_raw_data) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (Joint PIRL)</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, state_abbreviation, cip_code,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>              Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (JOINT)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">AS</span> entry_date,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>),</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>),</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.jointpirl_raw_data</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ssn_valid_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">between</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,  <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,     <span class="co">-- source data does not contain gross monthly income</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,       <span class="co">-- source data does not contain net monthly income</span></span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>            pirl.entry_date,</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>            pirl.exit_date</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,            </span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---adult-education" class="level4">
<h4 class="anchored" data-anchor-id="pirl---adult-education">PIRL - Adult Education</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load thefffflsfll FACT_Person_Program_Observation_Quarter table with data for the "Adult Education (WIOA)" program.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - adult education)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb13-278"><a href="#cb13-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb13-279"><a href="#cb13-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb13-280"><a href="#cb13-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-281"><a href="#cb13-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb13-282"><a href="#cb13-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb13-283"><a href="#cb13-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb13-284"><a href="#cb13-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb13-285"><a href="#cb13-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb13-286"><a href="#cb13-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb13-287"><a href="#cb13-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb13-288"><a href="#cb13-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-289"><a href="#cb13-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-290"><a href="#cb13-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb13-291"><a href="#cb13-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb13-292"><a href="#cb13-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb13-293"><a href="#cb13-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-294"><a href="#cb13-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-295"><a href="#cb13-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb13-296"><a href="#cb13-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb13-319"><a href="#cb13-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb13-320"><a href="#cb13-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb13-321"><a href="#cb13-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb13-322"><a href="#cb13-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb13-323"><a href="#cb13-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb13-324"><a href="#cb13-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb13-325"><a href="#cb13-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb13-326"><a href="#cb13-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb13-327"><a href="#cb13-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb13-328"><a href="#cb13-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb13-329"><a href="#cb13-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb13-330"><a href="#cb13-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-331"><a href="#cb13-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb13-332"><a href="#cb13-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb13-333"><a href="#cb13-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb13-334"><a href="#cb13-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb13-335"><a href="#cb13-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb13-336"><a href="#cb13-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb13-337"><a href="#cb13-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb13-338"><a href="#cb13-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb13-339"><a href="#cb13-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb13-340"><a href="#cb13-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb13-341"><a href="#cb13-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb13-342"><a href="#cb13-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb13-343"><a href="#cb13-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb13-344"><a href="#cb13-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb13-345"><a href="#cb13-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb13-346"><a href="#cb13-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb13-347"><a href="#cb13-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb13-348"><a href="#cb13-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb13-349"><a href="#cb13-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb13-350"><a href="#cb13-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb13-351"><a href="#cb13-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb13-352"><a href="#cb13-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb13-353"><a href="#cb13-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb13-354"><a href="#cb13-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb13-355"><a href="#cb13-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb13-356"><a href="#cb13-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb13-357"><a href="#cb13-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb13-358"><a href="#cb13-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb13-359"><a href="#cb13-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb13-360"><a href="#cb13-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb13-361"><a href="#cb13-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb13-362"><a href="#cb13-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb13-363"><a href="#cb13-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb13-364"><a href="#cb13-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb13-365"><a href="#cb13-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb13-366"><a href="#cb13-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb13-367"><a href="#cb13-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb13-368"><a href="#cb13-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb13-369"><a href="#cb13-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---adult" class="level4">
<h4 class="anchored" data-anchor-id="pirl---adult">PIRL - Adult</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Adult (WIOA)" program.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - adult)</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.adult_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---dislocated-worker" class="level4">
<h4 class="anchored" data-anchor-id="pirl---dislocated-worker">PIRL - Dislocated Worker</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Dislocated Worker (WIOA)" program.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - dislocated worker)</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Dislocated Worker (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.dislocated_worker_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb15-360"><a href="#cb15-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb15-361"><a href="#cb15-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb15-367"><a href="#cb15-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb15-368"><a href="#cb15-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---job-corps" class="level4">
<h4 class="anchored" data-anchor-id="pirl---job-corps">Pirl - Job Corps</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Job Corps (WIOA)" program.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - job corps)</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Job Corps (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.job_corps_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb16-351"><a href="#cb16-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb16-352"><a href="#cb16-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb16-353"><a href="#cb16-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb16-354"><a href="#cb16-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb16-355"><a href="#cb16-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb16-356"><a href="#cb16-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb16-357"><a href="#cb16-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb16-358"><a href="#cb16-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb16-359"><a href="#cb16-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb16-360"><a href="#cb16-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb16-361"><a href="#cb16-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb16-362"><a href="#cb16-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb16-363"><a href="#cb16-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb16-364"><a href="#cb16-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb16-365"><a href="#cb16-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb16-366"><a href="#cb16-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb16-367"><a href="#cb16-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb16-368"><a href="#cb16-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb16-369"><a href="#cb16-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---vocational-rehab" class="level4">
<h4 class="anchored" data-anchor-id="pirl---vocational-rehab">PIRL - Vocational Rehab</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Vocational Rehabilitation (WIOA)" program.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - vocational rehab)</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Vocational Rehabilitation (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.vocational_rehabilitation_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---wagner-peyser" class="level4">
<h4 class="anchored" data-anchor-id="pirl---wagner-peyser">PIRL - Wagner Peyser</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Wagner-Peyser Employment Service (WIOA)" program.</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - wagner peyser)</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Wagner-Peyser Employment Service (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.wagner_peyser_employment_service_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb18-293"><a href="#cb18-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb18-324"><a href="#cb18-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb18-325"><a href="#cb18-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb18-354"><a href="#cb18-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb18-355"><a href="#cb18-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb18-365"><a href="#cb18-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb18-366"><a href="#cb18-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---youth-build" class="level4">
<h4 class="anchored" data-anchor-id="pirl---youth-build">PIRL - Youth Build</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "YouthBuild (WIOA)" program.</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - youth build)</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'YouthBuild (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> pirl.youthbuild_wioa <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb19-338"><a href="#cb19-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb19-339"><a href="#cb19-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb19-349"><a href="#cb19-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb19-350"><a href="#cb19-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb19-351"><a href="#cb19-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb19-352"><a href="#cb19-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb19-353"><a href="#cb19-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb19-354"><a href="#cb19-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb19-355"><a href="#cb19-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb19-362"><a href="#cb19-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb19-363"><a href="#cb19-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---youth" class="level4">
<h4 class="anchored" data-anchor-id="pirl---youth">PIRL - Youth</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Youth (WIOA)" program.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">        The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The ctePirl data is then process in the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData data is duplicated for each quarter in the range of entry_quarter and exit_quarter and returned in cteResults.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteResults is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (PIRL - youth)</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>              Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Youth (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, GETDATE()) <span class="kw">AS</span> exit_date,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a measurable skills gain'</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship'</span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training'</span></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training'</span></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training'</span></span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youth_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement,  Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status,</span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a>             entry_date, exit_date)</span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb20-239"><a href="#cb20-239" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb20-240"><a href="#cb20-240" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb20-249"><a href="#cb20-249" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb20-250"><a href="#cb20-250" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb20-260"><a href="#cb20-260" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb20-261"><a href="#cb20-261" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status,</span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a>            entry_date,</span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a>            exit_date</span>
<span id="cb20-268"><a href="#cb20-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb20-269"><a href="#cb20-269" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a>cteResults (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a>            Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb20-279"><a href="#cb20-279" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb20-280"><a href="#cb20-280" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-281"><a href="#cb20-281" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb20-282"><a href="#cb20-282" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb20-283"><a href="#cb20-283" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb20-284"><a href="#cb20-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb20-285"><a href="#cb20-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb20-286"><a href="#cb20-286" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb20-287"><a href="#cb20-287" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb20-288"><a href="#cb20-288" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-289"><a href="#cb20-289" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-290"><a href="#cb20-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb20-291"><a href="#cb20-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb20-292"><a href="#cb20-292" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb20-293"><a href="#cb20-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-294"><a href="#cb20-294" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-295"><a href="#cb20-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb20-296"><a href="#cb20-296" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb20-297"><a href="#cb20-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb20-298"><a href="#cb20-298" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-299"><a href="#cb20-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteFactData.Exit_Year_Quarter_Key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteFactData.exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb20-300"><a href="#cb20-300" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Yes'</span></span>
<span id="cb20-301"><a href="#cb20-301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb20-302"><a href="#cb20-302" aria-hidden="true" tabindex="-1"></a>            Gross_Monthly_Income,</span>
<span id="cb20-303"><a href="#cb20-303" aria-hidden="true" tabindex="-1"></a>            Net_Monthly_Income,</span>
<span id="cb20-304"><a href="#cb20-304" aria-hidden="true" tabindex="-1"></a>            Date_of_Most_Recent_Career_Service,</span>
<span id="cb20-305"><a href="#cb20-305" aria-hidden="true" tabindex="-1"></a>            Received_Training,</span>
<span id="cb20-306"><a href="#cb20-306" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Name,</span>
<span id="cb20-307"><a href="#cb20-307" aria-hidden="true" tabindex="-1"></a>            Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb20-308"><a href="#cb20-308" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_1,</span>
<span id="cb20-309"><a href="#cb20-309" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_1,</span>
<span id="cb20-310"><a href="#cb20-310" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_2,</span>
<span id="cb20-311"><a href="#cb20-311" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_2,</span>
<span id="cb20-312"><a href="#cb20-312" aria-hidden="true" tabindex="-1"></a>            Date_Entered_Training_3,</span>
<span id="cb20-313"><a href="#cb20-313" aria-hidden="true" tabindex="-1"></a>            Type_of_Training_Service_3,</span>
<span id="cb20-314"><a href="#cb20-314" aria-hidden="true" tabindex="-1"></a>            Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb20-315"><a href="#cb20-315" aria-hidden="true" tabindex="-1"></a>            Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb20-316"><a href="#cb20-316" aria-hidden="true" tabindex="-1"></a>            Enrolled_in_Secondary_Education_Program,</span>
<span id="cb20-317"><a href="#cb20-317" aria-hidden="true" tabindex="-1"></a>            Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb20-318"><a href="#cb20-318" aria-hidden="true" tabindex="-1"></a>            Youth_2nd_Quarter_Placement,</span>
<span id="cb20-319"><a href="#cb20-319" aria-hidden="true" tabindex="-1"></a>            Youth_4th_Quarter_Placement,</span>
<span id="cb20-320"><a href="#cb20-320" aria-hidden="true" tabindex="-1"></a>            Other_Reason_for_Exit,</span>
<span id="cb20-321"><a href="#cb20-321" aria-hidden="true" tabindex="-1"></a>            Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb20-322"><a href="#cb20-322" aria-hidden="true" tabindex="-1"></a>            Individual_with_a_Disability,</span>
<span id="cb20-323"><a href="#cb20-323" aria-hidden="true" tabindex="-1"></a>            Zip_Code_of_Residence,</span>
<span id="cb20-324"><a href="#cb20-324" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Student_Level,</span>
<span id="cb20-325"><a href="#cb20-325" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Enrollment_Status,</span>
<span id="cb20-326"><a href="#cb20-326" aria-hidden="true" tabindex="-1"></a>            Higher_Education_Tuition_Status</span>
<span id="cb20-327"><a href="#cb20-327" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFactData</span>
<span id="cb20-328"><a href="#cb20-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb20-329"><a href="#cb20-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteFactData.Entry_Year_Quarter_Key <span class="kw">AND</span> cteFactData.Exit_Year_Quarter_Key</span>
<span id="cb20-330"><a href="#cb20-330" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-331"><a href="#cb20-331" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb20-332"><a href="#cb20-332" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb20-333"><a href="#cb20-333" aria-hidden="true" tabindex="-1"></a>        Observation_Year_Quarter_Key,</span>
<span id="cb20-334"><a href="#cb20-334" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb20-335"><a href="#cb20-335" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb20-336"><a href="#cb20-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb20-337"><a href="#cb20-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb20-338"><a href="#cb20-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> Enrolled_First_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Second_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> Enrolled_Third_Month_of_Quarter <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb20-339"><a href="#cb20-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb20-340"><a href="#cb20-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb20-341"><a href="#cb20-341" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb20-342"><a href="#cb20-342" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb20-343"><a href="#cb20-343" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb20-344"><a href="#cb20-344" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb20-345"><a href="#cb20-345" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb20-346"><a href="#cb20-346" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb20-347"><a href="#cb20-347" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb20-348"><a href="#cb20-348" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb20-349"><a href="#cb20-349" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb20-350"><a href="#cb20-350" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb20-351"><a href="#cb20-351" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb20-352"><a href="#cb20-352" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb20-353"><a href="#cb20-353" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb20-354"><a href="#cb20-354" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb20-355"><a href="#cb20-355" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb20-356"><a href="#cb20-356" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb20-357"><a href="#cb20-357" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb20-358"><a href="#cb20-358" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb20-359"><a href="#cb20-359" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb20-360"><a href="#cb20-360" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb20-361"><a href="#cb20-361" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb20-362"><a href="#cb20-362" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb20-363"><a href="#cb20-363" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb20-364"><a href="#cb20-364" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb20-365"><a href="#cb20-365" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb20-366"><a href="#cb20-366" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb20-367"><a href="#cb20-367" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb20-368"><a href="#cb20-368" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb20-369"><a href="#cb20-369" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteResults;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="snap" class="level4">
<h4 class="anchored" data-anchor-id="snap">SNAP</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Supplemental Nutrition Assistance Program (SNAP)" program.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Find unique eligible cases and associate each unique case with a entry quarter and an exit quarter.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">        The cert_start_date is used to determine the entry quarter and the cert_end_date is used to determine the exit quarter.</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAPEligibleCase common table expression (CTE).</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Sum gross_monthly_income and net_monthly_income grouping on case, ssn, start quarter and exit quarter.</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAPIncome CTE.</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each case found in step 1 and supplement that data with the aggregated income values from step 2.</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAP CTE.</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for eacn cteSNap record.</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 5</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (SNAP)</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteSNAPEligibleCase (case_unit_id, year_qtr_key, start_file_date, end_file_date)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  snap_case.case_unit_id,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>            obs_qtr.Year_Quarter_Key <span class="kw">AS</span> year_qtr_key,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(file_month) <span class="kw">AS</span> start_file_date,</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(file_month) <span class="kw">AS</span> end_file_date</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.snap_case</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter obs_qtr</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> snap_case.file_month <span class="kw">BETWEEN</span> obs_qtr.Quarter_Start_Date <span class="kw">AND</span> obs_qtr.Quarter_End_Date</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">YEAR</span>, snap_case.file_month) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_case.snap_eligibility <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_case.file_month <span class="kw">BETWEEN</span> snap_case.cert_start_date <span class="kw">AND</span> snap_case.cert_end_date</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> snap_case.case_unit_id, obs_qtr.Year_Quarter_Key</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>cteSNAPIncome (case_unit_id, social_security_number, year_qtr_key, qtr_first_month, qtr_second_month,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>               qtr_third_month, gross_monthly_income, net_monthly_income, file_month)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  sec.case_unit_id,</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>            si.SSN <span class="kw">AS</span> social_security_number,</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>            sec.year_qtr_key,</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, si.file_month) <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_first_month,</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, si.file_month) <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_second_month,</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, si.file_month) <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_third_month,</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> si.gross_income_mo_indicator <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> si.gross_income_mo <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> gross_monthly_income,</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> si.net_income_mo_indicator <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> si.net_income_mo <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> net_monthly_income,</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(si.file_month)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAPEligibleCase sec</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.snap_individual si</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> sec.case_unit_id <span class="op">=</span> si.case_unit_id</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> si.file_month <span class="kw">BETWEEN</span> sec.start_file_date <span class="kw">AND</span> sec.end_file_date</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> si.valid_ssn_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> si.ssn <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> ssn <span class="kw">FROM</span> ds_ar_dhs.snap_individual <span class="kw">GROUP</span> <span class="kw">BY</span> ssn, file_month <span class="kw">HAVING</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> sec.case_unit_id, si.SSN, sec.year_qtr_key</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>cteSNAP (social_security_number, program_name, year_qtr_key, state_abbreviation, Enrolled_Entire_Quarter,</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>         Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter,</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>         Gross_Monthly_Income, Net_Monthly_Income)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.social_security_number,</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Supplemental Nutrition Assistance Program (SNAP)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>            <span class="co">--OBSERVATION YEAR QUARTER KEY</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.year_qtr_key,</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>            snap.state <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> cteSNAPIncome.qtr_first_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteSNAPIncome.qtr_second_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteSNAPIncome.qtr_third_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.qtr_first_month <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.qtr_second_month <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.qtr_third_month <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter,</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(cteSNAPIncome.gross_monthly_income <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>)) <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(cteSNAPIncome.net_monthly_income <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>)) <span class="kw">AS</span> Net_Monthly_Income</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAPIncome</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.snap_individual snap</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> cteSNAPIncome.case_unit_id <span class="op">=</span> snap.case_unit_id</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteSNAPIncome.social_security_number <span class="op">=</span> snap.ssn</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteSNAPIncome.file_month <span class="op">=</span> snap.file_month</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">YEAR</span>, snap.file_month) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>             Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter,</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2,</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> snap.social_security_number</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> snap.program_name</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Observation Year Quarter Surrogate Key</span></span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>            snap.year_qtr_key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,   <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> snap.state_abbreviation</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,    <span class="co">-- source data does not contain state of residence</span></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>            <span class="co">--CIP Surrogate Key</span></span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> CIP_Classification_Key,    <span class="co">-- source data does not contain CIP Classification</span></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>            snap.Enrolled_Entire_Quarter,</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>            snap.Enrolled_First_Month_of_Quarter,</span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>            snap.Enrolled_Second_Month_of_Quarter,</span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>            snap.Enrolled_Third_Month_of_Quarter,</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>            snap.Gross_Monthly_Income <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>            snap.Net_Monthly_Income <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAP snap</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Observation_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a>        Enrolled_Entire_Quarter,</span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tanf" class="level4">
<h4 class="anchored" data-anchor-id="tanf">TANF</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Observation_Quarter table with data for the "Temporary Assistance for Needy Families (TANF)" program.</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Get a list of exit records for each ssn and observation quarter.</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">        The observation quarter is calculated from the reporting_month.</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteTANFQuarter common table expression (CTE).</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each record in cteTANFQuarter.</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteTANF CTE.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for each cteTANF record.</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Observation Quarter (TANF)</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Observation_Quarter (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                                                     CIP_Classification_Key, Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                                                     Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter, Gross_Monthly_Income, Net_Monthly_Income,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                                                     Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                                                     Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                                                     Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                                                     Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                                                     Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>                                                     Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>                                                     Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                                                     Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                                                     Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteTANFQuarter (social_security_number, year_qtr_key, qtr_first_month, qtr_second_month, qtr_third_month, reporting_month)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  tanf_member.social_security_number,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'01'</span>, <span class="st">'04'</span>, <span class="st">'07'</span>, <span class="st">'10'</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_first_month,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'02'</span>, <span class="st">'05'</span>, <span class="st">'08'</span>, <span class="st">'11'</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_second_month,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'03'</span>, <span class="st">'06'</span>, <span class="st">'09'</span>, <span class="st">'12'</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span> <span class="cf">ELSE</span> <span class="st">'No'</span> <span class="cf">END</span>) <span class="kw">AS</span> qtr_third_month,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(tanf_member.reporting_month)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(tanf_member.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>) <span class="kw">BETWEEN</span> qtr.Quarter_Start_Date <span class="kw">AND</span> qtr.Quarter_End_Date</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> <span class="kw">LEFT</span>(tanf_member.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tanf_member.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tanf_member.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> tanf_member.social_security_number, qtr.Year_Quarter_Key</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>cteTANF (social_security_number, program_name, year_qtr_key, state_fips_code, Enrolled_Entire_Quarter,</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>         Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>            tanf_member.social_security_number,</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Temporary Assistance for Needy Families (TANF)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--OBSERVATION YEAR QUARTER KEY</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>            cteTANFQuarter.year_qtr_key,</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>            tanf_member.state_fips_code,</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> cteTANFQuarter.qtr_first_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteTANFQuarter.qtr_second_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> cteTANFQuarter.qtr_third_month <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>            cteTANFQuarter.qtr_first_month <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>            cteTANFQuarter.qtr_second_month <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>            cteTANFQuarter.qtr_third_month <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteTANFQuarter</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.tanf_member</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> cteTANFQuarter.social_security_number <span class="op">=</span> tanf_member.social_security_number</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteTANFQuarter.reporting_month <span class="op">=</span> tanf_member.reporting_month</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> <span class="kw">LEFT</span>(tanf_member.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tanf_member.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tanf_member.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Observation_Year_Quarter_Key, County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key,</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>             Enrolled_Entire_Quarter, Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter,</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>             Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name,</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>             Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>             Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>             Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> tanf.social_security_number</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> tanf.program_name</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Observation Year Quarter Surrogate Key</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>            tanf.year_qtr_key <span class="kw">AS</span> Observation_Year_Quarter_Key,</span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,   <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_FIPS_Code <span class="op">=</span> tanf.state_fips_code</span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,    <span class="co">-- source data does not contain state of residence</span></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>            <span class="co">--CIP Surrogate Key</span></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> CIP_Classification_Key,    <span class="co">-- source data does not contain CIP Classification</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a>            tanf.Enrolled_Entire_Quarter,</span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a>            tanf.Enrolled_First_Month_of_Quarter,</span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a>            tanf.Enrolled_Second_Month_of_Quarter,</span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a>            tanf.Enrolled_Third_Month_of_Quarter,</span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,      <span class="co">-- source data does not contain gross monthly income</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,        <span class="co">-- source data does not contain net monthly income</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteTANF tanf</span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Observation_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a>        Enrolled_Entire_Quarter,</span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>        Enrolled_First_Month_of_Quarter,</span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a>        Enrolled_Second_Month_of_Quarter,</span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>        Enrolled_Third_Month_of_Quarter,</span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fact-person-program-participation-tables" class="level3">
<h3 class="anchored" data-anchor-id="fact-person-program-participation-tables">FACT Person Program Participation Tables</h3>
<section id="higher-education-1" class="level4">
<h4 class="anchored" data-anchor-id="higher-education-1">Higher Education</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Higher Education" program.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Try to remove duplicated higher education records by grouping on ssn, entry quarter, and exit quarter and selecting</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">            the minium academic_year and miniumum term for each grouping.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The entry and exit quarters are calculated using academic_year and term.  Academic_year has to be adjusted to calendar year. </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each record found in step 1.</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteHigherEducation CTE.</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for each cteHigherEducation record.</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (Higher Education)</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteDeDuplicate (social_security_number, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, academic_year, academic_term)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  se.ssn_id <span class="kw">AS</span> social_security_number,</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            entry_qtr.Year_Quarter_Key <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>            exit_qtr.Year_Quarter_Key <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(se.academic_year),</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(se.term) <span class="kw">AS</span> academic_term</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhe.student_enrollment_table se</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> entry_qtr.calendar_year <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(se.academic_year <span class="kw">AS</span> <span class="dt">INT</span>) <span class="op">-</span> <span class="dv">1</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">4</span>)) <span class="cf">ELSE</span> se.academic_year <span class="cf">END</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> entry_qtr.calendar_quarter <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'4'</span>) <span class="cf">THEN</span> <span class="st">'3'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="st">'3'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'2'</span>, <span class="st">'6'</span>) <span class="cf">THEN</span> <span class="st">'1'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'3'</span>, <span class="st">'7'</span>) <span class="cf">THEN</span> <span class="st">'2'</span> <span class="cf">END</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> exit_qtr.calendar_year <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CAST</span>(se.academic_year <span class="kw">AS</span> <span class="dt">INT</span>) <span class="op">-</span> <span class="dv">1</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">4</span>)) <span class="cf">ELSE</span> se.academic_year <span class="cf">END</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> exit_qtr.calendar_quarter <span class="op">=</span> <span class="cf">CASE</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'4'</span>) <span class="cf">THEN</span> <span class="st">'3'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'5'</span>) <span class="cf">THEN</span> <span class="st">'4'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'2'</span>, <span class="st">'6'</span>) <span class="cf">THEN</span> <span class="st">'2'</span> <span class="cf">WHEN</span> se.term <span class="kw">IN</span> (<span class="st">'3'</span>, <span class="st">'7'</span>) <span class="cf">THEN</span> <span class="st">'2'</span> <span class="cf">END</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> se.academic_year <span class="op">&gt;=</span> <span class="st">'2011'</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.ssn_valid_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.term <span class="kw">IN</span> (<span class="st">'0'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>, <span class="st">'5'</span>, <span class="st">'6'</span>, <span class="st">'7'</span>)</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> se.ssn_id, entry_qtr.Year_Quarter_Key, exit_qtr.Year_Quarter_Key</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>cteHigherEducation (social_security_number, program_name, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_FIPS_Code, state_abbreviation, cip_code, cip_detail,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                    Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>                    Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                    Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                    Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                    Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry, </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>                    Participated_in_Postsecondary_Education_During_Program_Participation, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>                    Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  cteDeDuplicate.social_security_number,</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Higher Education'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.Entry_Year_Quarter_Key,</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>            cteDeDuplicate.Exit_Year_Quarter_Key,</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(se.geo_county, <span class="st">''</span>) <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(se.geo_state, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(dfy.cip_code, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(dfy.cip_detail, <span class="st">''</span>) <span class="kw">AS</span> cip_detail,</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="op">=</span> <span class="st">'14'</span> <span class="cf">THEN</span> <span class="st">'11'</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="op">=</span> <span class="st">'13'</span> <span class="cf">THEN</span> <span class="st">''</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.diploma_ged <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">''</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'12'</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> </span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">IN</span> (<span class="st">'02'</span>,<span class="st">'03'</span>,<span class="st">'04'</span>) <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">IN</span> (<span class="st">'05'</span>, <span class="st">'06'</span>, <span class="st">'10'</span>) <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">IN</span> (<span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>) <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">IN</span> (<span class="st">'13'</span>, <span class="st">'14'</span>) <span class="cf">THEN</span> <span class="st">''</span></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.diploma_ged <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">IN</span> (<span class="st">'13'</span>, <span class="st">'14'</span>) <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> se.student_level <span class="kw">BETWEEN</span> <span class="st">'01'</span> <span class="kw">AND</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">3</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">3</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(rsl.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(res.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(rts.descr, <span class="st">''</span>) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhe.student_enrollment_table se</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> cteDeDuplicate</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.ssn_id <span class="op">=</span> cteDeDuplicate.social_security_number</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.academic_year <span class="op">=</span> cteDeDuplicate.academic_year</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>        <span class="kw">and</span> se.term <span class="op">=</span> cteDeDuplicate.academic_term</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.degree_fice_year_Table dfy</span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.fice_code <span class="op">=</span> dfy.fice_code</span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.academic_year <span class="op">=</span> dfy.academic_year</span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> se.major_1 <span class="op">=</span> dfy.degree_code</span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.refenrollstatus res</span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.enroll_status <span class="op">=</span> res.enrollstatusid</span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.refstudentlevel rsl</span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.student_level <span class="op">=</span> rsl.countryid     <span class="co">-- note: The name of the PK for this table is probably a typo (i.e. incorrect)</span></span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> ds_ar_dhe.reftuitionstatus rts</span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> se.tuition_status <span class="op">=</span> rts.tuitionstatusid</span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> se.academic_year <span class="op">&gt;=</span> <span class="st">'2011'</span></span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> se.ssn_valid_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb23-122"><a href="#cb23-122" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb23-123"><a href="#cb23-123" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb23-124"><a href="#cb23-124" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb23-125"><a href="#cb23-125" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb23-126"><a href="#cb23-126" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb23-127"><a href="#cb23-127" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb23-128"><a href="#cb23-128" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb23-129"><a href="#cb23-129" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence,</span>
<span id="cb23-130"><a href="#cb23-130" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Student_Level, Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb23-131"><a href="#cb23-131" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb23-132"><a href="#cb23-132" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-133"><a href="#cb23-133" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb23-134"><a href="#cb23-134" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-135"><a href="#cb23-135" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb23-136"><a href="#cb23-136" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb23-137"><a href="#cb23-137" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> he.social_security_number</span>
<span id="cb23-138"><a href="#cb23-138" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb23-139"><a href="#cb23-139" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb23-140"><a href="#cb23-140" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-141"><a href="#cb23-141" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb23-142"><a href="#cb23-142" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb23-143"><a href="#cb23-143" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> he.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb23-144"><a href="#cb23-144" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb23-145"><a href="#cb23-145" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb23-146"><a href="#cb23-146" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb23-147"><a href="#cb23-147" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb23-148"><a href="#cb23-148" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb23-149"><a href="#cb23-149" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb23-150"><a href="#cb23-150" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb23-151"><a href="#cb23-151" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb23-152"><a href="#cb23-152" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb23-153"><a href="#cb23-153" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb23-154"><a href="#cb23-154" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb23-155"><a href="#cb23-155" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb23-156"><a href="#cb23-156" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb23-157"><a href="#cb23-157" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> he.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb23-158"><a href="#cb23-158" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb23-159"><a href="#cb23-159" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb23-160"><a href="#cb23-160" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-161"><a href="#cb23-161" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb23-162"><a href="#cb23-162" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb23-163"><a href="#cb23-163" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> he.program_name</span>
<span id="cb23-164"><a href="#cb23-164" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb23-165"><a href="#cb23-165" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Entry Year Quarter Surrogate Key</span></span>
<span id="cb23-166"><a href="#cb23-166" aria-hidden="true" tabindex="-1"></a>            he.Entry_Year_Quarter_Key,</span>
<span id="cb23-167"><a href="#cb23-167" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Exit Year Quarter Surrogate Key</span></span>
<span id="cb23-168"><a href="#cb23-168" aria-hidden="true" tabindex="-1"></a>            he.Exit_Year_Quarter_Key,</span>
<span id="cb23-169"><a href="#cb23-169" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb23-170"><a href="#cb23-170" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-171"><a href="#cb23-171" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb23-172"><a href="#cb23-172" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb23-173"><a href="#cb23-173" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> he.County_FIPS_Code</span>
<span id="cb23-174"><a href="#cb23-174" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb23-175"><a href="#cb23-175" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb23-176"><a href="#cb23-176" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-177"><a href="#cb23-177" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb23-178"><a href="#cb23-178" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb23-179"><a href="#cb23-179" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> he.state_abbreviation</span>
<span id="cb23-180"><a href="#cb23-180" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb23-181"><a href="#cb23-181" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb23-182"><a href="#cb23-182" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb23-183"><a href="#cb23-183" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb23-184"><a href="#cb23-184" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb23-185"><a href="#cb23-185" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> <span class="fu">CONCAT</span>(he.cip_code, <span class="fu">CONCAT</span>(<span class="fu">CAST</span>(<span class="st">'.'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)), he.cip_detail))</span>
<span id="cb23-186"><a href="#cb23-186" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb23-187"><a href="#cb23-187" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb23-188"><a href="#cb23-188" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb23-189"><a href="#cb23-189" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb23-190"><a href="#cb23-190" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb23-191"><a href="#cb23-191" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb23-192"><a href="#cb23-192" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb23-193"><a href="#cb23-193" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb23-194"><a href="#cb23-194" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb23-195"><a href="#cb23-195" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb23-196"><a href="#cb23-196" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb23-197"><a href="#cb23-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb23-198"><a href="#cb23-198" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb23-199"><a href="#cb23-199" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb23-200"><a href="#cb23-200" aria-hidden="true" tabindex="-1"></a>            he.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb23-201"><a href="#cb23-201" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb23-202"><a href="#cb23-202" aria-hidden="true" tabindex="-1"></a>            he.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb23-203"><a href="#cb23-203" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb23-204"><a href="#cb23-204" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb23-205"><a href="#cb23-205" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb23-206"><a href="#cb23-206" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Incarcerated_at_Program_Entry,</span>
<span id="cb23-207"><a href="#cb23-207" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Released_from_Incarceration,</span>
<span id="cb23-208"><a href="#cb23-208" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb23-209"><a href="#cb23-209" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb23-210"><a href="#cb23-210" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb23-211"><a href="#cb23-211" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb23-212"><a href="#cb23-212" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Student_Level,</span>
<span id="cb23-213"><a href="#cb23-213" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Enrollment_Status,</span>
<span id="cb23-214"><a href="#cb23-214" aria-hidden="true" tabindex="-1"></a>            he.Higher_Education_Tuition_Status</span>
<span id="cb23-215"><a href="#cb23-215" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteHigherEducation he</span>
<span id="cb23-216"><a href="#cb23-216" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-217"><a href="#cb23-217" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb23-218"><a href="#cb23-218" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb23-219"><a href="#cb23-219" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb23-220"><a href="#cb23-220" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb23-221"><a href="#cb23-221" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb23-222"><a href="#cb23-222" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb23-223"><a href="#cb23-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb23-224"><a href="#cb23-224" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb23-225"><a href="#cb23-225" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb23-226"><a href="#cb23-226" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb23-227"><a href="#cb23-227" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb23-228"><a href="#cb23-228" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb23-229"><a href="#cb23-229" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb23-230"><a href="#cb23-230" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb23-231"><a href="#cb23-231" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb23-232"><a href="#cb23-232" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb23-233"><a href="#cb23-233" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb23-234"><a href="#cb23-234" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb23-235"><a href="#cb23-235" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb23-236"><a href="#cb23-236" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb23-237"><a href="#cb23-237" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb23-238"><a href="#cb23-238" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb23-239"><a href="#cb23-239" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb23-240"><a href="#cb23-240" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb23-241"><a href="#cb23-241" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb23-242"><a href="#cb23-242" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb23-243"><a href="#cb23-243" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb23-244"><a href="#cb23-244" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb23-245"><a href="#cb23-245" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb23-246"><a href="#cb23-246" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb23-247"><a href="#cb23-247" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb23-248"><a href="#cb23-248" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb23-249"><a href="#cb23-249" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb23-250"><a href="#cb23-250" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb23-251"><a href="#cb23-251" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status, </span>
<span id="cb23-252"><a href="#cb23-252" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb23-253"><a href="#cb23-253" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="joint-pirl-2" class="level4">
<h4 class="anchored" data-anchor-id="joint-pirl-2">JOINT PIRL</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Adult Education (JOINT)" program.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.jointpirl_raw_data) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (JOINT PIRL)</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, state_abbreviation, cip_code, Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>              Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry, Employment_Status_at_Program_Entry,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>              Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry, Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>              Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry, Low_Income_Status_at_Program_Entry,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>              English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry, Cultural_Barriers_at_Program_Entry,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>              Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry, Date_of_Most_Recent_Career_Service, Received_Training,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>              Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>              Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>              Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>              Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>              Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (JOINT)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">AS</span> entry_date,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>),</span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>),</span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb24-250"><a href="#cb24-250" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.jointpirl_raw_data</span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ssn_valid_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-291"><a href="#cb24-291" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb24-292"><a href="#cb24-292" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb24-309"><a href="#cb24-309" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb24-310"><a href="#cb24-310" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb24-313"><a href="#cb24-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb24-314"><a href="#cb24-314" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">between</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,  <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb24-330"><a href="#cb24-330" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-331"><a href="#cb24-331" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-337"><a href="#cb24-337" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb24-338"><a href="#cb24-338" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,     <span class="co">-- source data does not contain gross monthly income</span></span>
<span id="cb24-343"><a href="#cb24-343" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,       <span class="co">-- source data does not contain net monthly income</span></span>
<span id="cb24-344"><a href="#cb24-344" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb24-345"><a href="#cb24-345" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb24-346"><a href="#cb24-346" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb24-351"><a href="#cb24-351" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb24-352"><a href="#cb24-352" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb24-358"><a href="#cb24-358" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb24-359"><a href="#cb24-359" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb24-361"><a href="#cb24-361" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb24-362"><a href="#cb24-362" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb24-365"><a href="#cb24-365" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb24-366"><a href="#cb24-366" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb24-373"><a href="#cb24-373" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb24-374"><a href="#cb24-374" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb24-380"><a href="#cb24-380" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb24-381"><a href="#cb24-381" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb24-388"><a href="#cb24-388" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb24-389"><a href="#cb24-389" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb24-397"><a href="#cb24-397" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb24-398"><a href="#cb24-398" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb24-403"><a href="#cb24-403" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb24-404"><a href="#cb24-404" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb24-405"><a href="#cb24-405" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---adult-education-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---adult-education-1">PIRL - Adult Education</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Adult Education (WIOA)" program.</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - adult education)</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult Education (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb25-300"><a href="#cb25-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---adult-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---adult-1">PIRL - Adult</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Adult (WIOA)" program.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - adult)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Adult (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb26-156"><a href="#cb26-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb26-166"><a href="#cb26-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb26-167"><a href="#cb26-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb26-170"><a href="#cb26-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb26-171"><a href="#cb26-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-181"><a href="#cb26-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb26-182"><a href="#cb26-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb26-189"><a href="#cb26-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb26-190"><a href="#cb26-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-197"><a href="#cb26-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-198"><a href="#cb26-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb26-205"><a href="#cb26-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb26-206"><a href="#cb26-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-213"><a href="#cb26-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-214"><a href="#cb26-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-217"><a href="#cb26-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-218"><a href="#cb26-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-221"><a href="#cb26-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-222"><a href="#cb26-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-229"><a href="#cb26-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-230"><a href="#cb26-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb26-231"><a href="#cb26-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb26-235"><a href="#cb26-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-236"><a href="#cb26-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb26-239"><a href="#cb26-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb26-240"><a href="#cb26-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-246"><a href="#cb26-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-247"><a href="#cb26-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb26-254"><a href="#cb26-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb26-255"><a href="#cb26-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb26-266"><a href="#cb26-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-267"><a href="#cb26-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-269"><a href="#cb26-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb26-270"><a href="#cb26-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb26-274"><a href="#cb26-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb26-275"><a href="#cb26-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb26-280"><a href="#cb26-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb26-281"><a href="#cb26-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb26-282"><a href="#cb26-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb26-283"><a href="#cb26-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb26-287"><a href="#cb26-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb26-288"><a href="#cb26-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb26-297"><a href="#cb26-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb26-298"><a href="#cb26-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb26-299"><a href="#cb26-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb26-309"><a href="#cb26-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb26-310"><a href="#cb26-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb26-318"><a href="#cb26-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb26-319"><a href="#cb26-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-321"><a href="#cb26-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb26-322"><a href="#cb26-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb26-328"><a href="#cb26-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb26-329"><a href="#cb26-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb26-332"><a href="#cb26-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-333"><a href="#cb26-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb26-334"><a href="#cb26-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb26-344"><a href="#cb26-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-345"><a href="#cb26-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb26-352"><a href="#cb26-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb26-353"><a href="#cb26-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb26-357"><a href="#cb26-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb26-358"><a href="#cb26-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb26-359"><a href="#cb26-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb26-368"><a href="#cb26-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb26-369"><a href="#cb26-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb26-370"><a href="#cb26-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb26-371"><a href="#cb26-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb26-372"><a href="#cb26-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb26-373"><a href="#cb26-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb26-374"><a href="#cb26-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb26-375"><a href="#cb26-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb26-376"><a href="#cb26-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb26-377"><a href="#cb26-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb26-378"><a href="#cb26-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb26-379"><a href="#cb26-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb26-380"><a href="#cb26-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb26-381"><a href="#cb26-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb26-382"><a href="#cb26-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb26-383"><a href="#cb26-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb26-384"><a href="#cb26-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-385"><a href="#cb26-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb26-386"><a href="#cb26-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb26-387"><a href="#cb26-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb26-388"><a href="#cb26-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb26-389"><a href="#cb26-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb26-390"><a href="#cb26-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb26-391"><a href="#cb26-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb26-392"><a href="#cb26-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb26-393"><a href="#cb26-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb26-394"><a href="#cb26-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb26-395"><a href="#cb26-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb26-396"><a href="#cb26-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb26-397"><a href="#cb26-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb26-398"><a href="#cb26-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb26-399"><a href="#cb26-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb26-400"><a href="#cb26-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb26-401"><a href="#cb26-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb26-402"><a href="#cb26-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb26-403"><a href="#cb26-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb26-404"><a href="#cb26-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb26-405"><a href="#cb26-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb26-406"><a href="#cb26-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb26-407"><a href="#cb26-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb26-408"><a href="#cb26-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb26-409"><a href="#cb26-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb26-410"><a href="#cb26-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb26-411"><a href="#cb26-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb26-412"><a href="#cb26-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb26-413"><a href="#cb26-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb26-414"><a href="#cb26-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb26-415"><a href="#cb26-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb26-416"><a href="#cb26-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb26-417"><a href="#cb26-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb26-418"><a href="#cb26-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb26-419"><a href="#cb26-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb26-420"><a href="#cb26-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---dislocated-worker-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---dislocated-worker-1">PIRL - Dislocated Worker</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Dislocated Worker (WIOA)" program.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - dislocated worker)</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Dislocated Worker (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-150"><a href="#cb27-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb27-151"><a href="#cb27-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb27-153"><a href="#cb27-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb27-154"><a href="#cb27-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb27-156"><a href="#cb27-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb27-157"><a href="#cb27-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb27-158"><a href="#cb27-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb27-159"><a href="#cb27-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb27-160"><a href="#cb27-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb27-161"><a href="#cb27-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-162"><a href="#cb27-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-163"><a href="#cb27-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-164"><a href="#cb27-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb27-165"><a href="#cb27-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb27-166"><a href="#cb27-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb27-167"><a href="#cb27-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb27-168"><a href="#cb27-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb27-169"><a href="#cb27-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb27-170"><a href="#cb27-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb27-171"><a href="#cb27-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb27-172"><a href="#cb27-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb27-173"><a href="#cb27-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb27-174"><a href="#cb27-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb27-175"><a href="#cb27-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb27-176"><a href="#cb27-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb27-177"><a href="#cb27-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb27-178"><a href="#cb27-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-179"><a href="#cb27-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-180"><a href="#cb27-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-181"><a href="#cb27-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb27-182"><a href="#cb27-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb27-183"><a href="#cb27-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb27-184"><a href="#cb27-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb27-185"><a href="#cb27-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb27-186"><a href="#cb27-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb27-187"><a href="#cb27-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb27-188"><a href="#cb27-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb27-189"><a href="#cb27-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb27-190"><a href="#cb27-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb27-191"><a href="#cb27-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb27-192"><a href="#cb27-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb27-193"><a href="#cb27-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb27-194"><a href="#cb27-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb27-195"><a href="#cb27-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-196"><a href="#cb27-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-197"><a href="#cb27-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-198"><a href="#cb27-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb27-199"><a href="#cb27-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb27-200"><a href="#cb27-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb27-201"><a href="#cb27-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb27-202"><a href="#cb27-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb27-203"><a href="#cb27-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb27-204"><a href="#cb27-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb27-205"><a href="#cb27-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb27-206"><a href="#cb27-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb27-207"><a href="#cb27-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb27-208"><a href="#cb27-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb27-209"><a href="#cb27-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb27-210"><a href="#cb27-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb27-211"><a href="#cb27-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb27-212"><a href="#cb27-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-213"><a href="#cb27-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-214"><a href="#cb27-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb27-215"><a href="#cb27-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-216"><a href="#cb27-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-217"><a href="#cb27-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-218"><a href="#cb27-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-219"><a href="#cb27-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb27-220"><a href="#cb27-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-221"><a href="#cb27-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-222"><a href="#cb27-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-223"><a href="#cb27-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-224"><a href="#cb27-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb27-225"><a href="#cb27-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-226"><a href="#cb27-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-227"><a href="#cb27-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-228"><a href="#cb27-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-229"><a href="#cb27-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-230"><a href="#cb27-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb27-231"><a href="#cb27-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb27-232"><a href="#cb27-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb27-233"><a href="#cb27-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb27-234"><a href="#cb27-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb27-235"><a href="#cb27-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-236"><a href="#cb27-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-237"><a href="#cb27-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb27-238"><a href="#cb27-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb27-239"><a href="#cb27-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb27-240"><a href="#cb27-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb27-241"><a href="#cb27-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb27-242"><a href="#cb27-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-243"><a href="#cb27-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-244"><a href="#cb27-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb27-245"><a href="#cb27-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-246"><a href="#cb27-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-247"><a href="#cb27-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-248"><a href="#cb27-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-249"><a href="#cb27-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb27-250"><a href="#cb27-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb27-251"><a href="#cb27-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb27-252"><a href="#cb27-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb27-253"><a href="#cb27-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb27-254"><a href="#cb27-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb27-255"><a href="#cb27-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb27-256"><a href="#cb27-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb27-257"><a href="#cb27-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-258"><a href="#cb27-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-259"><a href="#cb27-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-260"><a href="#cb27-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb27-261"><a href="#cb27-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb27-262"><a href="#cb27-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb27-263"><a href="#cb27-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb27-264"><a href="#cb27-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb27-265"><a href="#cb27-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb27-266"><a href="#cb27-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-267"><a href="#cb27-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-268"><a href="#cb27-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-269"><a href="#cb27-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb27-270"><a href="#cb27-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb27-271"><a href="#cb27-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb27-272"><a href="#cb27-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb27-273"><a href="#cb27-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb27-274"><a href="#cb27-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb27-275"><a href="#cb27-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb27-276"><a href="#cb27-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb27-277"><a href="#cb27-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb27-278"><a href="#cb27-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb27-279"><a href="#cb27-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb27-280"><a href="#cb27-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> dislocated_worker_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb27-281"><a href="#cb27-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb27-282"><a href="#cb27-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb27-283"><a href="#cb27-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb27-284"><a href="#cb27-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb27-285"><a href="#cb27-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb27-286"><a href="#cb27-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb27-287"><a href="#cb27-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb27-288"><a href="#cb27-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb27-289"><a href="#cb27-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb27-290"><a href="#cb27-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb27-291"><a href="#cb27-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb27-292"><a href="#cb27-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-293"><a href="#cb27-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb27-294"><a href="#cb27-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-295"><a href="#cb27-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb27-296"><a href="#cb27-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb27-297"><a href="#cb27-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb27-298"><a href="#cb27-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb27-299"><a href="#cb27-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb27-300"><a href="#cb27-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-301"><a href="#cb27-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb27-302"><a href="#cb27-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb27-303"><a href="#cb27-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb27-304"><a href="#cb27-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb27-305"><a href="#cb27-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb27-306"><a href="#cb27-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb27-307"><a href="#cb27-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb27-308"><a href="#cb27-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb27-309"><a href="#cb27-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb27-310"><a href="#cb27-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb27-311"><a href="#cb27-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb27-312"><a href="#cb27-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb27-313"><a href="#cb27-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb27-314"><a href="#cb27-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb27-315"><a href="#cb27-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb27-316"><a href="#cb27-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb27-317"><a href="#cb27-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb27-318"><a href="#cb27-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb27-319"><a href="#cb27-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb27-320"><a href="#cb27-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-321"><a href="#cb27-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb27-322"><a href="#cb27-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb27-323"><a href="#cb27-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb27-324"><a href="#cb27-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb27-325"><a href="#cb27-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb27-326"><a href="#cb27-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-327"><a href="#cb27-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb27-328"><a href="#cb27-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb27-329"><a href="#cb27-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb27-330"><a href="#cb27-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb27-331"><a href="#cb27-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb27-332"><a href="#cb27-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-333"><a href="#cb27-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb27-334"><a href="#cb27-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb27-335"><a href="#cb27-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb27-336"><a href="#cb27-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb27-337"><a href="#cb27-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb27-338"><a href="#cb27-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-339"><a href="#cb27-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb27-340"><a href="#cb27-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb27-341"><a href="#cb27-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb27-342"><a href="#cb27-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb27-343"><a href="#cb27-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb27-344"><a href="#cb27-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-345"><a href="#cb27-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb27-346"><a href="#cb27-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb27-347"><a href="#cb27-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb27-348"><a href="#cb27-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb27-349"><a href="#cb27-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb27-350"><a href="#cb27-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb27-351"><a href="#cb27-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb27-352"><a href="#cb27-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb27-353"><a href="#cb27-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb27-354"><a href="#cb27-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb27-355"><a href="#cb27-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb27-356"><a href="#cb27-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb27-357"><a href="#cb27-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb27-358"><a href="#cb27-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb27-359"><a href="#cb27-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb27-360"><a href="#cb27-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb27-361"><a href="#cb27-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb27-362"><a href="#cb27-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb27-363"><a href="#cb27-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb27-364"><a href="#cb27-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb27-365"><a href="#cb27-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb27-366"><a href="#cb27-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb27-367"><a href="#cb27-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb27-368"><a href="#cb27-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb27-369"><a href="#cb27-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb27-370"><a href="#cb27-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb27-371"><a href="#cb27-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb27-372"><a href="#cb27-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb27-373"><a href="#cb27-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb27-374"><a href="#cb27-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb27-375"><a href="#cb27-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb27-376"><a href="#cb27-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb27-377"><a href="#cb27-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb27-378"><a href="#cb27-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb27-379"><a href="#cb27-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb27-380"><a href="#cb27-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb27-381"><a href="#cb27-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb27-382"><a href="#cb27-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb27-383"><a href="#cb27-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb27-384"><a href="#cb27-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-385"><a href="#cb27-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb27-386"><a href="#cb27-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb27-387"><a href="#cb27-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb27-388"><a href="#cb27-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb27-389"><a href="#cb27-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb27-390"><a href="#cb27-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb27-391"><a href="#cb27-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb27-392"><a href="#cb27-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb27-393"><a href="#cb27-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb27-394"><a href="#cb27-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb27-395"><a href="#cb27-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb27-396"><a href="#cb27-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb27-397"><a href="#cb27-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb27-398"><a href="#cb27-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb27-399"><a href="#cb27-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb27-400"><a href="#cb27-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb27-401"><a href="#cb27-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb27-402"><a href="#cb27-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb27-403"><a href="#cb27-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb27-404"><a href="#cb27-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb27-405"><a href="#cb27-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb27-406"><a href="#cb27-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb27-407"><a href="#cb27-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb27-408"><a href="#cb27-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb27-409"><a href="#cb27-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb27-410"><a href="#cb27-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb27-411"><a href="#cb27-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb27-412"><a href="#cb27-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb27-413"><a href="#cb27-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb27-414"><a href="#cb27-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb27-415"><a href="#cb27-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb27-416"><a href="#cb27-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb27-417"><a href="#cb27-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb27-418"><a href="#cb27-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb27-419"><a href="#cb27-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb27-420"><a href="#cb27-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---job-corps-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---job-corps-1">PIRL - Job Corps</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Job Corps (WIOA)" program.</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - job corps)</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Job Corps (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> job_corps_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl-vocational-rehab" class="level4">
<h4 class="anchored" data-anchor-id="pirl-vocational-rehab">PIRL Vocational Rehab</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Vocational Rehabilitation (WIOA)" program.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - vocational rehab)</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Vocational Rehabilitation (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-216"><a href="#cb29-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-217"><a href="#cb29-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-230"><a href="#cb29-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb29-231"><a href="#cb29-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-236"><a href="#cb29-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-237"><a href="#cb29-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb29-239"><a href="#cb29-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb29-240"><a href="#cb29-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb29-242"><a href="#cb29-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-243"><a href="#cb29-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb29-245"><a href="#cb29-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-246"><a href="#cb29-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb29-252"><a href="#cb29-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb29-253"><a href="#cb29-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb29-263"><a href="#cb29-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb29-264"><a href="#cb29-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> vocational_rehabilitation_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-295"><a href="#cb29-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb29-389"><a href="#cb29-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb29-399"><a href="#cb29-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb29-400"><a href="#cb29-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb29-407"><a href="#cb29-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb29-408"><a href="#cb29-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb29-409"><a href="#cb29-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb29-410"><a href="#cb29-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl-wagner-peyser" class="level4">
<h4 class="anchored" data-anchor-id="pirl-wagner-peyser">PIRL Wagner Peyser</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Wagner-Peyser Employment Service (WIOA)" program.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - wagner peyser)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Wagner-Peyser Employment Service (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb30-190"><a href="#cb30-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb30-191"><a href="#cb30-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb30-208"><a href="#cb30-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb30-209"><a href="#cb30-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-247"><a href="#cb30-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-248"><a href="#cb30-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-268"><a href="#cb30-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> wagner_peyser_employment_service_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb30-282"><a href="#cb30-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb30-283"><a href="#cb30-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb30-302"><a href="#cb30-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb30-326"><a href="#cb30-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb30-340"><a href="#cb30-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb30-341"><a href="#cb30-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb30-351"><a href="#cb30-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb30-391"><a href="#cb30-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb30-395"><a href="#cb30-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb30-396"><a href="#cb30-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---youth-build-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---youth-build-1">PIRL - Youth Build</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "YouthBuild (WIOA)" program.</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - youth build)</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'YouthBuild (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-150"><a href="#cb31-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb31-151"><a href="#cb31-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb31-160"><a href="#cb31-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb31-161"><a href="#cb31-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-162"><a href="#cb31-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-163"><a href="#cb31-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-164"><a href="#cb31-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb31-165"><a href="#cb31-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb31-166"><a href="#cb31-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb31-167"><a href="#cb31-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb31-168"><a href="#cb31-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb31-169"><a href="#cb31-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb31-170"><a href="#cb31-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb31-171"><a href="#cb31-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb31-172"><a href="#cb31-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb31-173"><a href="#cb31-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb31-174"><a href="#cb31-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb31-175"><a href="#cb31-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb31-176"><a href="#cb31-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb31-177"><a href="#cb31-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb31-178"><a href="#cb31-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-179"><a href="#cb31-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-180"><a href="#cb31-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-181"><a href="#cb31-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb31-182"><a href="#cb31-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb31-183"><a href="#cb31-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb31-184"><a href="#cb31-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb31-185"><a href="#cb31-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb31-186"><a href="#cb31-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb31-187"><a href="#cb31-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb31-188"><a href="#cb31-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb31-189"><a href="#cb31-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb31-190"><a href="#cb31-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb31-191"><a href="#cb31-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb31-192"><a href="#cb31-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb31-193"><a href="#cb31-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb31-194"><a href="#cb31-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb31-195"><a href="#cb31-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-196"><a href="#cb31-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-197"><a href="#cb31-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-198"><a href="#cb31-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb31-199"><a href="#cb31-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb31-200"><a href="#cb31-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb31-201"><a href="#cb31-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb31-202"><a href="#cb31-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb31-203"><a href="#cb31-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb31-204"><a href="#cb31-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb31-205"><a href="#cb31-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb31-206"><a href="#cb31-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb31-207"><a href="#cb31-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb31-208"><a href="#cb31-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb31-209"><a href="#cb31-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb31-210"><a href="#cb31-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb31-211"><a href="#cb31-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb31-212"><a href="#cb31-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-213"><a href="#cb31-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-214"><a href="#cb31-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb31-215"><a href="#cb31-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-216"><a href="#cb31-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-217"><a href="#cb31-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-218"><a href="#cb31-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-219"><a href="#cb31-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb31-220"><a href="#cb31-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-221"><a href="#cb31-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-222"><a href="#cb31-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-223"><a href="#cb31-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-224"><a href="#cb31-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb31-225"><a href="#cb31-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-226"><a href="#cb31-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-227"><a href="#cb31-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-228"><a href="#cb31-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-229"><a href="#cb31-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-230"><a href="#cb31-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb31-231"><a href="#cb31-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb31-232"><a href="#cb31-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb31-233"><a href="#cb31-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb31-234"><a href="#cb31-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb31-235"><a href="#cb31-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-236"><a href="#cb31-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-237"><a href="#cb31-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb31-238"><a href="#cb31-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb31-239"><a href="#cb31-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb31-240"><a href="#cb31-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb31-241"><a href="#cb31-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb31-242"><a href="#cb31-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-243"><a href="#cb31-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-244"><a href="#cb31-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb31-245"><a href="#cb31-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-246"><a href="#cb31-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-247"><a href="#cb31-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-248"><a href="#cb31-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-249"><a href="#cb31-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb31-250"><a href="#cb31-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb31-251"><a href="#cb31-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb31-252"><a href="#cb31-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb31-253"><a href="#cb31-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb31-254"><a href="#cb31-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb31-255"><a href="#cb31-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb31-256"><a href="#cb31-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb31-257"><a href="#cb31-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-258"><a href="#cb31-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-259"><a href="#cb31-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-260"><a href="#cb31-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb31-261"><a href="#cb31-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb31-262"><a href="#cb31-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb31-263"><a href="#cb31-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb31-264"><a href="#cb31-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb31-265"><a href="#cb31-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb31-266"><a href="#cb31-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-267"><a href="#cb31-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-268"><a href="#cb31-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-269"><a href="#cb31-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb31-270"><a href="#cb31-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb31-271"><a href="#cb31-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb31-272"><a href="#cb31-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb31-273"><a href="#cb31-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb31-274"><a href="#cb31-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb31-275"><a href="#cb31-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb31-276"><a href="#cb31-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb31-277"><a href="#cb31-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb31-278"><a href="#cb31-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb31-279"><a href="#cb31-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb31-280"><a href="#cb31-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youthbuild_wioa <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb31-281"><a href="#cb31-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb31-282"><a href="#cb31-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb31-283"><a href="#cb31-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb31-284"><a href="#cb31-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb31-285"><a href="#cb31-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb31-286"><a href="#cb31-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb31-287"><a href="#cb31-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb31-288"><a href="#cb31-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb31-289"><a href="#cb31-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb31-290"><a href="#cb31-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb31-291"><a href="#cb31-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb31-292"><a href="#cb31-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb31-293"><a href="#cb31-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb31-294"><a href="#cb31-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-295"><a href="#cb31-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb31-296"><a href="#cb31-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb31-297"><a href="#cb31-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb31-298"><a href="#cb31-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb31-299"><a href="#cb31-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb31-300"><a href="#cb31-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-301"><a href="#cb31-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb31-302"><a href="#cb31-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb31-303"><a href="#cb31-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb31-304"><a href="#cb31-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb31-305"><a href="#cb31-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb31-306"><a href="#cb31-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb31-307"><a href="#cb31-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb31-308"><a href="#cb31-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb31-309"><a href="#cb31-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb31-310"><a href="#cb31-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb31-311"><a href="#cb31-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb31-312"><a href="#cb31-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb31-313"><a href="#cb31-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb31-314"><a href="#cb31-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb31-315"><a href="#cb31-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb31-316"><a href="#cb31-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb31-317"><a href="#cb31-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb31-318"><a href="#cb31-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb31-319"><a href="#cb31-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb31-320"><a href="#cb31-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-321"><a href="#cb31-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb31-322"><a href="#cb31-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb31-323"><a href="#cb31-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb31-324"><a href="#cb31-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb31-325"><a href="#cb31-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb31-326"><a href="#cb31-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-327"><a href="#cb31-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb31-328"><a href="#cb31-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb31-329"><a href="#cb31-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb31-330"><a href="#cb31-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb31-331"><a href="#cb31-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb31-332"><a href="#cb31-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-333"><a href="#cb31-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb31-334"><a href="#cb31-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb31-335"><a href="#cb31-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb31-336"><a href="#cb31-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb31-337"><a href="#cb31-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb31-338"><a href="#cb31-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-339"><a href="#cb31-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb31-340"><a href="#cb31-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb31-341"><a href="#cb31-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb31-342"><a href="#cb31-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb31-343"><a href="#cb31-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb31-344"><a href="#cb31-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-345"><a href="#cb31-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb31-346"><a href="#cb31-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb31-347"><a href="#cb31-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb31-348"><a href="#cb31-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb31-349"><a href="#cb31-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb31-350"><a href="#cb31-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb31-351"><a href="#cb31-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb31-352"><a href="#cb31-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb31-353"><a href="#cb31-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb31-354"><a href="#cb31-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb31-355"><a href="#cb31-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb31-356"><a href="#cb31-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb31-357"><a href="#cb31-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb31-358"><a href="#cb31-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb31-359"><a href="#cb31-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb31-360"><a href="#cb31-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb31-361"><a href="#cb31-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb31-362"><a href="#cb31-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb31-363"><a href="#cb31-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb31-364"><a href="#cb31-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb31-365"><a href="#cb31-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb31-366"><a href="#cb31-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb31-367"><a href="#cb31-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb31-368"><a href="#cb31-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb31-369"><a href="#cb31-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb31-370"><a href="#cb31-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb31-371"><a href="#cb31-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb31-372"><a href="#cb31-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb31-373"><a href="#cb31-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb31-374"><a href="#cb31-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb31-375"><a href="#cb31-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb31-376"><a href="#cb31-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb31-377"><a href="#cb31-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb31-378"><a href="#cb31-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb31-379"><a href="#cb31-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb31-380"><a href="#cb31-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb31-381"><a href="#cb31-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb31-382"><a href="#cb31-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb31-383"><a href="#cb31-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb31-384"><a href="#cb31-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-385"><a href="#cb31-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb31-386"><a href="#cb31-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb31-387"><a href="#cb31-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb31-388"><a href="#cb31-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb31-389"><a href="#cb31-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb31-390"><a href="#cb31-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb31-391"><a href="#cb31-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb31-392"><a href="#cb31-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb31-393"><a href="#cb31-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb31-394"><a href="#cb31-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb31-395"><a href="#cb31-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb31-396"><a href="#cb31-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb31-397"><a href="#cb31-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb31-398"><a href="#cb31-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb31-399"><a href="#cb31-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb31-400"><a href="#cb31-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb31-401"><a href="#cb31-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb31-402"><a href="#cb31-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb31-403"><a href="#cb31-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb31-404"><a href="#cb31-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb31-405"><a href="#cb31-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb31-406"><a href="#cb31-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb31-407"><a href="#cb31-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb31-408"><a href="#cb31-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb31-409"><a href="#cb31-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb31-410"><a href="#cb31-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb31-411"><a href="#cb31-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb31-412"><a href="#cb31-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb31-413"><a href="#cb31-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb31-414"><a href="#cb31-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb31-415"><a href="#cb31-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb31-416"><a href="#cb31-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb31-417"><a href="#cb31-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb31-418"><a href="#cb31-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb31-419"><a href="#cb31-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb31-420"><a href="#cb31-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl---youth-1" class="level4">
<h4 class="anchored" data-anchor-id="pirl---youth-1">PIRL - Youth</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "YouthBuild (WIOA)" program.</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 1</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The data is collected from the source table (ds_ar_dws.pirl) and returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Any reference values or boolean values are converted to text strings.</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 2</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">    The ctePirl data is then process thru the cteFactData CTE which looks up the dimension keys.</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Step 3</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (PIRL - youth build)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, program_name, entry_date, exit_date, County_FIPS_Code, state_abbreviation, cip_code,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>              Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>              Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>              Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>              Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>              Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>              Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_1, Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2,</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>              Date_Entered_Training_3, Type_of_Training_Service_3, Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>              Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program,</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>              Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, Youth_4th_Quarter_Placement,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>              Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>              Individual_with_a_Disability, Zip_Code_of_Residence)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'YouthBuild (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">as</span> entry_date,</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_program_exit_wioa, <span class="fu">CAST</span>(<span class="st">'9999-12-31'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)) <span class="kw">AS</span> exit_date,</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR COUNTY KEY</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> LEN(<span class="fu">RTRIM</span>(county_code_of_residence)) <span class="op">=</span> <span class="dv">3</span> <span class="kw">AND</span> states.State_FIPS_Code <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="fu">CONCAT</span>(states.State_FIPS_Code, county_code_of_residence) <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">5</span>))</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> County_FIPS_Code,</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(state_code_of_residence_wioa, <span class="st">''</span>) <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR CIP KEY</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_cip_code_wioa, <span class="st">''</span>) <span class="kw">AS</span> cip_code,</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(highest_school_grade_completed_at_program_entry_wioa, <span class="st">''</span>) <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> highest_educational_level_completed_at_program_entry_wioa</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Successfully completed an Individualized Education Program (IEP)'</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> school_status_at_program_entry_wioa</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'In-school, secondary school or less'</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'In-school, Alternative School'</span></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'In-school, Postsecondary school'</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Not attending school or Secondary School Dropout'</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; secondary school graduate or has a recognized equivalent'</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not attending school; within age of compulsory school attendance'</span></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status_at_program_entry_wioa</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed, but Received Notice of Termination of Employment or Military Separation is pending'</span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> long_term_unemployed_at_program_entry_wioa</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> exhausting_tanf_within_2_years_part_a_title_iv_of_the_social_security_act_at_program_entry_wioa</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> foster_care_youth_status_at_program_entry_wioa</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> homeless_participant_homeless_children_and_youths_or_runaway_youth_at_program_entry_wioa</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> ex_offender_status_at_program_entry_wioa</span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> low_income_status_at_program_entry_wioa</span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> english_language_learner_at_program_entry_wioa</span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> basic_skills_deficient_low_levels_of_literacy_at_program_entry</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> cultural_barriers_at_program_entry_wioa</span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> single_parent_at_program_entry_wioa</span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> displaced_homemaker_at_program_entry_wioa</span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_of_most_recent_career_service_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_wioa</span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(eligible_training_provider_name_training_service_1_wioa, <span class="st">''</span>),</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> eligible_training_provider_program_of_study_by_potential_outcome</span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an industry-recognized certificate or certification'</span></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a certificate of completion of a registered apprenticeship'</span></span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a license recognized by the State involved or the Federal Government'</span></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to an associate degree'</span></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a baccalaureate degree'</span></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a community college certificate of completion'</span></span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'7'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to a secondary school diploma or its equivalent'</span></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'8'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to employment'</span></span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'9'</span> <span class="cf">THEN</span> <span class="st">'A program of study leading to  a measurable skills gain'</span></span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_1_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_1_wioa</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_2, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_2_wioa</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_entered_training_3, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> type_of_training_service_3_wioa</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'On the Job Training (non-WIOA Youth).'</span></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Skill Upgrading'</span></span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Entrepreneurial Training (non-WIOA Youth)'</span></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'04'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL (contextualized or other) in conjunction with Training'</span></span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Customized Training'</span></span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training (non-WIOA Youth)'</span></span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'ABE or ESL NOT in conjunction with training (funded by Trade Adjustment Assistance only)'</span></span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'08'</span> <span class="cf">THEN</span> <span class="st">'Prerequisite Training'</span></span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'09'</span> <span class="cf">THEN</span> <span class="st">'Registered Apprenticeship '</span></span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'10'</span> <span class="cf">THEN</span> <span class="st">'Youth Occupational Skills Training                                                                                                            '</span></span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'11'</span> <span class="cf">THEN</span> <span class="st">'Other Non-Occupational-Skills Training   '</span></span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Job Readiness Training in conjunction with other training                                                   '</span></span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No Training Service'</span></span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> participated_in_postsecondary_education_during_program_participation_wioa</span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> received_training_from_programs_operated_by_the_private_sector</span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> enrolled_in_secondary_education_program_wioa</span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_enrolled_in_post_exit_education_or_training_program_leading_to_a_recognized_postsecondary_credential_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_2nd_quarter_placement_title_i_wioa</span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> youth_4th_quarter_placement_title_i_wioa</span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Occupational Skills Training'</span></span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Postsecondary Education'</span></span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Secondary Education'</span></span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No placement'</span></span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> incarcerated_at_program_entry_wioa</span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(date_released_from_incarceration_wioa, <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>)),</span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> other_reasons_for_exit_wioa</span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'01'</span> <span class="cf">THEN</span> <span class="st">'Institutionalized'</span></span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'02'</span> <span class="cf">THEN</span> <span class="st">'Health/Medical'</span></span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'03'</span> <span class="cf">THEN</span> <span class="st">'Deceased'</span></span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'05'</span> <span class="cf">THEN</span> <span class="st">'Foster Care'</span></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'06'</span> <span class="cf">THEN</span> <span class="st">'Ineligible'</span></span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'07'</span> <span class="cf">THEN</span> <span class="st">'Criminal Offender'</span></span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'00'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-259"><a href="#cb32-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> migrant_and_seasonal_farmworker_status</span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Seasonal Farmworker Adult'</span></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Migrant Farmworker Adult'</span></span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'MSFW Youth'</span></span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Dependent Adult'</span></span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Dependent Youth'</span></span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> individual_with_a_disability_wioa</span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span>,</span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">COALESCE</span>(zip_code_of_residence, <span class="st">''</span>)</span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State states</span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> pirl.state_code_of_residence_wioa <span class="op">=</span> states.state_abbreviation</span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youthbuild_wioa <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> pirl.social_security_number</span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> pirl.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> pirl.program_name</span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> pirl.exit_date <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup County Surrogate Key</span></span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_County.County_Key</span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_County</span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_County.County_FIPS_Code <span class="op">=</span> pirl.County_FIPS_Code</span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> County_of_Residence_Key,</span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> pirl.state_abbreviation</span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup CIP Surrogate Key</span></span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-351"><a href="#cb32-351" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_CIP.CIP_Key</span>
<span id="cb32-352"><a href="#cb32-352" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_CIP</span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_CIP.Classification_Code <span class="op">=</span> pirl.cip_code</span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> CIP_Classification_Key,</span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a>            pirl.Date_of_Most_Recent_Career_Service,</span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training,</span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Name,</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a>            pirl.Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb32-362"><a href="#cb32-362" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_1,</span>
<span id="cb32-363"><a href="#cb32-363" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_1,</span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_2,</span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_2,</span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Entered_Training_3,</span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a>            pirl.Type_of_Training_Service_3,</span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a>            pirl.Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a>            pirl.Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a>            pirl.Enrolled_in_Secondary_Education_Program,</span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_2nd_Quarter_Placement,</span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a>            pirl.Youth_4th_Quarter_Placement,</span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a>            pirl.Incarcerated_at_Program_Entry,</span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a>            pirl.Date_Released_from_Incarceration,</span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a>            pirl.Other_Reason_for_Exit,</span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>            pirl.Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a>            pirl.Individual_with_a_Disability,</span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a>            pirl.Zip_Code_of_Residence,</span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl pirl</span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="snap-1" class="level4">
<h4 class="anchored" data-anchor-id="snap-1">SNAP</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Supplemental Nutrition Assistance Program (SNAP)" program.</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Find unique eligible cases and associate each unique case with a entry quarter and an exit quarter.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">        The cert_start_date is used to determine the entry quarter and the cert_end_date is used to determine the exit quarter.</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAPEligibleCase common table expression (CTE).</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Sum gross_monthly_income and net_monthly_income grouping on case, ssn, start quarter and exit quarter.</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAPIncome CTE.</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each case found in step 1 and supplement that data with the aggregated income values from step 2.</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAP CTE.</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for eacn cteSNap record.</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 5</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (SNAP)</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteSNAPEligibleCase (case_unit_id, entry_quarter_key, exit_quarter_key, entry_file_date, exit_file_date)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  snap_case.case_unit_id,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>            entry_qtr.Year_Quarter_Key,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>            exit_qtr.Year_Quarter_Key,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(file_month),</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(file_month)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.snap_case</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> snap_case.cert_start_date <span class="kw">BETWEEN</span> entry_qtr.Quarter_Start_Date <span class="kw">AND</span> entry_qtr.Quarter_End_Date</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> snap_case.cert_end_date <span class="kw">BETWEEN</span> exit_qtr.Quarter_Start_Date <span class="kw">AND</span> exit_qtr.Quarter_End_Date</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">YEAR</span>, snap_case.file_month) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> DATEPART(<span class="dt">YEAR</span>, snap_case.cert_end_date) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_case.snap_eligibility <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_case.file_month <span class="kw">BETWEEN</span> snap_case.cert_start_date <span class="kw">AND</span> snap_case.cert_end_date</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> snap_case.case_unit_id, entry_qtr.Year_Quarter_Key, exit_qtr.Year_Quarter_Key</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>cteSNAPIncome (case_unit_id, social_security_number, entry_quarter_key, exit_quarter_key, gross_monthly_income, net_monthly_income, file_month)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  sec.case_unit_id,</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>            si.SSN,</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>            sec.entry_quarter_key,</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>            sec.exit_quarter_key,</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> si.gross_income_mo_indicator <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> si.gross_income_mo <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> gross_monthly_income,</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> si.net_income_mo_indicator <span class="op">=</span> <span class="dv">1</span> <span class="cf">THEN</span> si.net_income_mo <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> net_monthly_income,</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(si.file_month)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAPEligibleCase sec</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.snap_individual si</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> sec.case_unit_id <span class="op">=</span> si.case_unit_id</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> si.file_month <span class="kw">BETWEEN</span> sec.entry_file_date <span class="kw">AND</span> sec.exit_file_date</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> si.valid_ssn_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> si.ssn <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> <span class="kw">DISTINCT</span> ssn <span class="kw">FROM</span> ds_ar_dhs.snap_individual <span class="kw">GROUP</span> <span class="kw">BY</span> ssn, file_month <span class="kw">HAVING</span> <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> sec.case_unit_id, si.SSN, sec.entry_quarter_key, sec.exit_quarter_key</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>cteSNAP (social_security_number, program_name, entry_quarter_key, exit_quarter_key, state_abbreviation,</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>         Highest_School_Grade_Completed_at_Program_Entry, Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>         Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>         Foster_Care_Youth_Status_at_Program_Entry, Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>         Low_Income_Status_at_Program_Entry, English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>         Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>         Gross_Monthly_Income, Net_Monthly_Income)</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.social_security_number,</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Supplemental Nutrition Assistance Program (SNAP)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>            <span class="co">--ENTRY YEAR QUARTER KEY</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.entry_quarter_key,</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>            <span class="co">--EXIT YEAR QUARTER KEY</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>            cteSNAPIncome.exit_quarter_key,</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>            snap.state <span class="kw">AS</span> state_abbreviation,</span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'0'</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'1G'</span> <span class="cf">THEN</span> <span class="st">'1'</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'2G'</span> <span class="cf">THEN</span> <span class="st">'2'</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'3G'</span> <span class="cf">THEN</span> <span class="st">'3'</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'4G'</span> <span class="cf">THEN</span> <span class="st">'4'</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'5G'</span> <span class="cf">THEN</span> <span class="st">'5'</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'6G'</span> <span class="cf">THEN</span> <span class="st">'6'</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'7G'</span> <span class="cf">THEN</span> <span class="st">'7'</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'8G'</span> <span class="cf">THEN</span> <span class="st">'8'</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'9G'</span> <span class="cf">THEN</span> <span class="st">'9'</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'10G'</span> <span class="cf">THEN</span> <span class="st">'10'</span></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="op">=</span> <span class="st">'11G'</span> <span class="cf">THEN</span> <span class="st">'11'</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.highest_ed <span class="kw">IN</span> (<span class="st">'12G'</span>, <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>, <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>, <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>) <span class="cf">THEN</span> <span class="st">'12'</span></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> snap.highest_ed</span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'13'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'14'</span> <span class="cf">THEN</span> <span class="st">'Attained a secondary school equivalency'</span></span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'16'</span> <span class="cf">THEN</span> <span class="st">'Completed one of more years of postsecondary education'</span></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'17'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'18'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'19'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'20'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'21'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> snap.employment</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'6'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.relationship <span class="op">=</span> <span class="st">'01'</span> <span class="kw">and</span> snap.rel_child <span class="op">=</span> <span class="st">'4'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.relationship <span class="op">=</span> <span class="st">'01'</span> <span class="kw">and</span> snap.rel_child <span class="kw">IN</span> (<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>) <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> snap.relationship <span class="kw">IN</span> (<span class="st">'00'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>, <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>, <span class="st">'07'</span>) <span class="cf">then</span> <span class="st">'No'</span></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry,</span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>            <span class="co">--FACT MEASURES</span></span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(cteSNAPIncome.gross_monthly_income <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>)) <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(cteSNAPIncome.net_monthly_income <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">14</span>,<span class="dv">2</span>)) <span class="kw">AS</span> Net_Monthly_Income</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAPIncome</span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.snap_individual snap</span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> cteSNAPIncome.case_unit_id <span class="op">=</span> snap.case_unit_id</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteSNAPIncome.social_security_number <span class="op">=</span> snap.ssn</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteSNAPIncome.file_month <span class="op">=</span> snap.file_month</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">YEAR</span>, snap.file_month) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> snap.social_security_number</span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> snap.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> snap.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> snap.program_name</span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Entry Year Quarter Surrogate Key</span></span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a>            snap.entry_quarter_key <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Exit Year Quarter Surrogate Key</span></span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a>            snap.exit_quarter_key <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,   <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_Abbreviation <span class="op">=</span> snap.state_abbreviation</span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,</span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a>            <span class="co">--CIP Surrogate Key</span></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> CIP_Classification_Key,    <span class="co">-- source data does not contain CIP Classification</span></span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a>            snap.Gross_Monthly_Income <span class="kw">AS</span> Gross_Monthly_Income,</span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a>            snap.Net_Monthly_Income <span class="kw">AS</span> Net_Monthly_Income,</span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Incarcerated_at_Program_Entry,</span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Released_from_Incarceration,</span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteSNAP snap</span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tanf-1" class="level4">
<h4 class="anchored" data-anchor-id="tanf-1">TANF</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">  This script will load the the FACT_Person_Program_Participation table with data for the "Temporary Assistance for Needy Families (TANF)" program.</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Get a list of exit records for each ssn and reporting_month.</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Exit record will have tanf_end_of_spell = 'TRUE'.</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">        We only want the records that have tanf_start_of_spell = 'FALSE' in this step.</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSpellEnd common table expression (CTE).</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Calculate TANF spells for each person by looking for record that have tanf_start_of_spell = 'TRUE'.</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Records that have tanf_end_of_spell = 'FALSE' will be matched to the nearest exit data from Step 1.</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Records that have tanf_end_of_spell = 'TRUE' will use the tanf_end_of_spell as the exit date.</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteTANFSpell CTE.</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Collect data for each case found in step 2.</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteTANF CTE.</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co">        Lookup the dimension keys for each cteTANF record.</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteFactData CTE.</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 5</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co">        The cteFactData is inserted into the fact table.  Any keys that could not be found via the lookup are set to 0.</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Program Participation (TANF)</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Program_Participation (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                                               County_of_Residence_Key, State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                                               Net_Monthly_Income, Date_of_Most_Recent_Career_Service, Received_Training, Eligible_Training_Provider_Name, </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                                               Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1, Type_of_Training_Service_1, </span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                                               Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>                                               Participated_in_Postsecondary_Education_During_Program_Participation, </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>                                               Received_Training_from_Private_Section_Operated_Program, Enrolled_in_Secondary_Education_Program, </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>                                               Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>                                               Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>                                               Other_Reason_for_Exit, Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>                                               Zip_Code_of_Residence, Higher_Education_Student_Level, Higher_Education_Enrollment_Status, </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>                                               Higher_Education_Tuition_Status)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteSpellEnd (social_security_number, reporting_month)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> social_security_number, reporting_month</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> tanf_start_of_spell <span class="op">=</span> <span class="st">'FALSE'</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tanf_end_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tanf_member.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>cteTANFSpell (social_security_number, entry_date, exit_date)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  ts.social_security_number,</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(ts.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>),</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="fu">MIN</span>(cteSpellEnd.reporting_month) <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="fu">TO_DATE</span>(<span class="st">'9999-01-01'</span>, <span class="st">'YYYYMMDD'</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(<span class="fu">MIN</span>(cteSpellEnd.reporting_month), <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>)</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member ts</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> cteSpellEnd</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> ts.social_security_number <span class="op">=</span> cteSpellEnd.social_security_number</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> ts.reporting_month <span class="op">&lt;</span> cteSpellEnd.reporting_month</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> ts.tanf_start_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ts.tanf_end_of_spell <span class="op">=</span> <span class="st">'FALSE'</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(ts.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(ts.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ts.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> ts.social_security_number, ts.reporting_month</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span> </span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  tm.social_security_number,</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>            <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(tm.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>),</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(tm.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>)</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member tm</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> tm.tanf_start_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tm.tanf_end_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(tm.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tm.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tm.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>cteTANF (social_security_number, program_name, entry_date, exit_date, state_fips_code, Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>         Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry, Employment_Status_at_Program_Entry,</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>         Long_Term_Unemployment_at_Program_Entry, Exhausting_TANF_Within_2_Yrs_at_Program_Entry, Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>         Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry, Low_Income_Status_at_Program_Entry,</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>         English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry, Cultural_Barriers_at_Program_Entry,</span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>         Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry)</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PERSON KEY</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>            cteTANFSpell.social_security_number,</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR PROGRAM KEY</span></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'Temporary Assistance for Needy Families (TANF)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)),</span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR ENTRY YEAR QUARTER KEY</span></span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>            cteTANFSpell.entry_date,</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR EXIT YEAR QUARTER KEY</span></span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>            cteTANFSpell.exit_date,</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUE FOR STATE KEY</span></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>            tanf_member.state_fips_code,</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>            <span class="co">--LOOKUP VALUES FOR INTAKE CHARACTERISTICS KEY</span></span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> education_level <span class="kw">IN</span> (<span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>, <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>, <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>, <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>) <span class="cf">THEN</span> education_level</span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> education_level <span class="kw">IN</span> (<span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>, <span class="st">'16'</span>) <span class="cf">THEN</span> <span class="st">'12'</span></span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> education_level <span class="op">=</span> <span class="st">'98'</span> <span class="cf">THEN</span> <span class="st">'0'</span></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> education_level</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'12'</span> <span class="cf">THEN</span> <span class="st">'Attained secondary school diploma'</span></span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'16'</span> <span class="cf">THEN</span> <span class="st">'Attained a postsecondary technical or vocational certificate (non-degree)'</span></span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'13'</span> <span class="cf">THEN</span> <span class="st">'Attained an Associate degree'</span></span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'14'</span> <span class="cf">THEN</span> <span class="st">'Attained a Bachelor degree'</span></span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'15'</span> <span class="cf">THEN</span> <span class="st">'Attained a degree beyond a Bachelor degree'</span></span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'98'</span> <span class="cf">THEN</span> <span class="st">'No Educational Level Completed'</span></span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> School_Status_at_Program_Entry,</span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> employment_status</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Employed'</span></span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Not in labor force'</span></span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Unemployed'</span></span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="st">''</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Employment_Status_at_Program_Entry,</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Income_Status_at_Program_Entry,</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> English_Language_Learner_at_Program_Entry,</span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Cultural_Barriers_at_Program_Entry,</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Single_Parent_at_Program_Entry,</span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Displaced_Homemaker_at_Program_Entry</span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteTANFSpell</span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.tanf_member</span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> cteTANFSpell.social_security_number <span class="op">=</span> tanf_member.social_security_number</span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> cteTANFSpell.entry_date <span class="op">=</span> <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(tanf_member.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>)</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> tanf_member.tanf_start_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(tanf_member.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tanf_member.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Intake_Characteristics_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key, County_of_Residence_Key,</span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a>             State_of_Residence_Key, CIP_Classification_Key, Gross_Monthly_Income, Net_Monthly_Income, Date_of_Most_Recent_Career_Service,</span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a>             Received_Training, Eligible_Training_Provider_Name, Eligible_Training_Provider_Program_of_Study, Date_Entered_Training_1,</span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a>             Type_of_Training_Service_1, Date_Entered_Training_2, Type_of_Training_Service_2, Date_Entered_Training_3, Type_of_Training_Service_3, </span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a>             Participated_in_Postsecondary_Education_During_Program_Participation, Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a>             Enrolled_in_Secondary_Education_Program, Date_Enrolled_in_Post_Exit_Education_or_Training_Program, Youth_2nd_Quarter_Placement, </span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a>             Youth_4th_Quarter_Placement, Incarcerated_at_Program_Entry, Date_Released_from_Incarceration, Other_Reason_for_Exit,</span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a>             Migrant_and_Seasonal_Farmworker_Status, Individual_with_a_Disability, Zip_Code_of_Residence, Higher_Education_Student_Level,</span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a>             Higher_Education_Enrollment_Status, Higher_Education_Tuition_Status)</span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> tanf.social_security_number</span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Intake Characteristics Surrogate Key</span></span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Intake_Characteristics.Intake_Characteristics_Key</span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Intake_Characteristics</span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> tanf.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_School_Grade_Completed_at_Program_Entry</span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Highest_Education_Level_Completed_at_Program_Entry</span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.School_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.School_Status_at_Program_Entry</span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Employment_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Employment_Status_at_Program_Entry</span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Long_Term_Unemployment_at_Program_Entry</span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Exhausting_TANF_Within_2_Yrs_at_Program_Entry</span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Foster_Care_Youth_Status_at_Program_Entry</span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Homeless_or_Runaway_at_Program_Entry</span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Ex_Offender_Status_at_Program_Entry</span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Low_Income_Status_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Income_Status_at_Program_Entry</span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.English_Language_Learner_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.English_Language_Learner_at_Program_Entry</span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Low_Levels_of_Literacy_at_Program_Entry</span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Cultural_Barriers_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Cultural_Barriers_at_Program_Entry</span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Single_Parent_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Single_Parent_at_Program_Entry</span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a>                <span class="kw">AND</span> tanf.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> DIM_Intake_Characteristics.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Intake_Characteristics_Key,</span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> tanf.program_name</span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Entry Year Quarter Surrogate Key</span></span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> entry_qtr.Year_Quarter_Key</span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> tanf.entry_date <span class="kw">between</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date      </span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Entry_Year_Quarter_Key,</span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Exit Year Quarter Surrogate Key</span></span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> exit_qtr.Year_Quarter_Key</span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> tanf.exit_date <span class="kw">between</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Exit_Year_Quarter_Key,</span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a>            <span class="co">--County Surrogate Key</span></span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> County_of_Residence_Key,   <span class="co">-- source data does not contain county of residence</span></span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup State Surrogate Key</span></span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_State.State_Key</span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_State</span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_State.State_FIPS_Code <span class="op">=</span> tanf.state_fips_code</span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> State_of_Residence_Key,    <span class="co">-- source data does not contain state of residence</span></span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>            <span class="co">--CIP Surrogate Key</span></span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> CIP_Classification_Key,    <span class="co">-- source data does not contain CIP Classification</span></span>
<span id="cb34-203"><a href="#cb34-203" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Measures</span></span>
<span id="cb34-204"><a href="#cb34-204" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Gross_Monthly_Income,      <span class="co">-- source data does not contain gross monthly income</span></span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="kw">AS</span> Net_Monthly_Income,        <span class="co">-- source data does not contain net monthly income</span></span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_of_Most_Recent_Career_Service,</span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training,</span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Name,</span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_1,</span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_1,</span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_2,</span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_2,</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Entered_Training_3,</span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Type_of_Training_Service_3,</span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Enrolled_in_Secondary_Education_Program,</span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_2nd_Quarter_Placement,</span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Youth_4th_Quarter_Placement,</span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Incarcerated_at_Program_Entry,</span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">'9999-01-01'</span> <span class="kw">AS</span> <span class="dt">DATE</span>) <span class="kw">AS</span> Date_Released_from_Incarceration,</span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Other_Reason_for_Exit,</span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Individual_with_a_Disability,</span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">1</span>)) <span class="kw">AS</span> Zip_Code_of_Residence,</span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Student_Level,</span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Enrollment_Status,</span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>(<span class="st">''</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">100</span>)) <span class="kw">AS</span> Higher_Education_Tuition_Status</span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteTANF tanf</span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="fu">COALESCE</span>(Person_Key, <span class="dv">0</span>),</span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Intake_Characteristics_Key, <span class="dv">0</span>),</span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Program_Key, <span class="dv">0</span>),</span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Entry_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(Exit_Year_Quarter_Key, <span class="dv">0</span>),</span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(County_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(State_of_Residence_Key, <span class="dv">0</span>),</span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a>        <span class="fu">COALESCE</span>(CIP_Classification_Key, <span class="dv">0</span>),</span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a>        Gross_Monthly_Income,</span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a>        Net_Monthly_Income,</span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a>        Date_of_Most_Recent_Career_Service,</span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a>        Received_Training,</span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Name,</span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a>        Eligible_Training_Provider_Program_of_Study,</span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_1,</span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_1,</span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_2,</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_2,</span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a>        Date_Entered_Training_3,</span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>        Type_of_Training_Service_3,</span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a>        Participated_in_Postsecondary_Education_During_Program_Participation,</span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a>        Received_Training_from_Private_Section_Operated_Program,</span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>        Enrolled_in_Secondary_Education_Program,</span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>        Date_Enrolled_in_Post_Exit_Education_or_Training_Program,</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a>        Youth_2nd_Quarter_Placement,</span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a>        Youth_4th_Quarter_Placement,</span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a>        Incarcerated_at_Program_Entry,</span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a>        Date_Released_from_Incarceration,</span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>        Other_Reason_for_Exit,</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a>        Migrant_and_Seasonal_Farmworker_Status,</span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a>        Individual_with_a_Disability,</span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a>        Zip_Code_of_Residence,</span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Student_Level,</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Enrollment_Status,</span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>        Higher_Education_Tuition_Status</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fact-person-quarterly-program-enrollment-tables" class="level3">
<h3 class="anchored" data-anchor-id="fact-person-quarterly-program-enrollment-tables">FACT Person Quarterly Program Enrollment Tables</h3>
<section id="joint-pirl-3" class="level4">
<h4 class="anchored" data-anchor-id="joint-pirl-3">JOINT PIRL</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">This script will load the FACT Person Quarterly Program Enrollment table with data for the "Adult Education (JOINT)" program.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">        People with program enrollments in the source table (ds_ar_dws.jointpirl_raw_data) are returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Redundancy in the source data requires grouping  the enrollments for an individual and program entry date in order to determine</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">        the correct program exit date.  The program exit date can be null is some situation and any null dates are converted to the </span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">        current date in step 2.</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the ctePIRL common table expression (CTE).</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">        The entry and exit dates in the ctePIRL CTE are converted to an entry quarter and an exit quarter.  If the exit date is null then</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">        the current date is used as the exit date.</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteQuarterRange CTE.</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">        This step looks up the dimension keys for the person and program and expands the results to include every quarter between the entry</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">        quarter and exit quarter (inclusive).  The minimm entry date or maximum exit date are used to calculate the</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co">        Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, and Enrolled_Third_Month_of_Quarter indicators for the first</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co">        and last quarters in the enrollment period.  All quarters between the entry and exit are assumed to include all months in the quarter.</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">        The results will include all quarters for each enrollment period a person might have.</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteFactData CTE.</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">        The value of the Enrolled_Entire_Quarter indicator is calculated and the results inserted into the fact table.</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Quarterly Program Enrollment (Joint PIRL)</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Quarterly_Program_Enrollment (Person_Key, Program_Key, Enrollment_Quarter_Key, Enrolled_Entire_Quarter,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                                                      Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (social_security_number, entry_date, exit_date)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> social_security_number, date_of_program_entry_wioa, <span class="fu">MAX</span>(date_of_program_exit_wioa)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.jointpirl_raw_data</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ssn_valid_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>cteQuarterRange (social_security_number, entry_quarter_key, exit_quarter_key, min_entry_date, max_exit_date)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  ctePirl.social_security_number,</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>            entry_qtr.Year_Quarter_Key <span class="kw">AS</span> entry_quarter_key,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>            exit_qtr.Year_Quarter_Key <span class="kw">AS</span> exit_quarter_key,</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(ctePirl.entry_date) <span class="kw">AS</span> min_entry_date,</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="fu">COALESCE</span>(ctePirl.exit_date, GETDATE())) <span class="kw">AS</span> max_exit_date</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> ctePirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date     </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> <span class="fu">COALESCE</span>(ctePirl.exit_date, GETDATE()) <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> ctePirl.social_security_number, entry_qtr.Year_Quarter_Key, exit_qtr.Year_Quarter_Key</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Enrollment_Year_Quarter_Key, Enrolled_First_Month_of_Quarter,</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>             Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> cteQuarterRange.social_security_number</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> <span class="st">'Adult Education (JOINT)'</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key,</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.min_entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Enrolled_First_Month_of_QuarterEntire_Quarter,</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.min_entry_date) <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.exit_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.max_exit_date) <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.exit_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.max_exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteQuarterRange</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> cteQuarterRange.exit_quarter_key</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  Person_Key,</span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>        Program_Key,</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>        Enrollment_Year_Quarter_Key,</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> <span class="fu">MAX</span>(Enrolled_First_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> <span class="fu">MAX</span>(Enrolled_Second_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> <span class="fu">MAX</span>(Enrolled_Third_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_First_Month_of_Quarter),</span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_Second_Month_of_Quarter),</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_Third_Month_of_Quarter)</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> Person_Key, Program_Key, Enrollment_Year_Quarter_Key;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pirl" class="level4">
<h4 class="anchored" data-anchor-id="pirl">PIRL</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">This script will load the FACT Person Quarterly Program Enrollment table with data for the PIRL (WIOA) programs.  This will include the</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">following programs:  Adult Education (WIOA),  Adult (WIOA), Dislocated Worker (WIOA), Job Corps (WIOA), Vocational Rehabilitation (WIOA),</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">                     Wagner-Peyser Employment Service (WIOA), Youth (WIOA), YouthBuild (WIOA)</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">        People with program enrollments in the source table (ds_ar_dws.pirl) are returned in the ctePIRL comment table expression (CTE).</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">        All of the programs enrollments are pull seperately and then unioned together. Redundancy in the source data requires grouping</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">        the enrollments for an individual and program entry date in order to determine the correct program exit date.  The program exit</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">        date can be null is some situation and any null dates are converted to the current date in step 2.</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the ctePIRL common table expression (CTE).</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The entry and exit dates in the ctePIRL CTE are converted to an entry quarter and an exit quarter.  If the exit date is null then</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">        the current date is used as the exit date.</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteQuarterRange CTE.</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">        This step looks up the dimension keys for the person and program and expands the results to include every quarter between the entry</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">        quarter and exit quarter (inclusive).  The minimm entry date or maximum exit date are used to calculate the</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">        Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, and Enrolled_Third_Month_of_Quarter indicators for the first</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co">        and last quarters in the enrollment period.  All quarters between the entry and exit are assumed to include all months in the quarter.</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">        The results will include all quarters for each enrollment period a person might have.</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteFactData CTE.</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">        The value of the Enrolled_Entire_Quarter indicator is calculated and the results inserted into the fact table.</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Quarterly Program Enrollment (PIRL - adult education)</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Quarterly_Program_Enrollment (Person_Key, Program_Key, Enrollment_Quarter_Key, Enrolled_Entire_Quarter,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>                                                      Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> ctePirl (program_name, social_security_number, entry_date, exit_date)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Adult Education</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Adult Education (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa <span class="kw">AS</span> entry_date,</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_education_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Adult</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Adult (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> adult_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Dislocated Worker</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Dislocated Worker (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> dislocated_worker_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Job Corps</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Job Corps (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> job_corps_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Vocational Rehabilitation</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Vocational Rehabilitation (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> vocational_rehabilitation_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Wagner-Peyser Employment Service</span></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Wagner-Peyser Employment Service (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> wagner_peyser_employment_service_wioa <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">--Youth</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'Youth (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youth_wioa <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>    <span class="co">--YouthBuild</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  <span class="fu">CAST</span>(<span class="st">'YouthBuild (WIOA)'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">75</span>)) <span class="kw">AS</span> program_name,</span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>            social_security_number,</span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>            date_of_program_entry_wioa,</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(date_of_program_exit_wioa) <span class="kw">AS</span> exit_date</span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl</span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> DATEPART(<span class="dt">year</span>, date_of_program_entry_wioa) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> youthbuild_wioa <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> social_security_number, date_of_program_entry_wioa</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>cteQuarterRange (program_name, social_security_number, entry_quarter_key, exit_quarter_key, min_entry_date, max_exit_date)</span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  ctePirl.program_name,</span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a>            ctePirl.social_security_number,</span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>            entry_qtr.Year_Quarter_Key,</span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>            exit_qtr.Year_Quarter_Key,</span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MIN</span>(ctePirl.entry_date) <span class="kw">AS</span> min_entry_date,</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MAX</span>(<span class="fu">COALESCE</span>(ctePirl.exit_date, GETDATE())) <span class="kw">AS</span> max_exit_date</span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ctePirl</span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter entry_qtr</span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> ctePirl.entry_date <span class="kw">BETWEEN</span> entry_qtr.quarter_start_date <span class="kw">AND</span> entry_qtr.quarter_end_date     </span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter exit_qtr</span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> <span class="fu">COALESCE</span>(ctePirl.exit_date, GETDATE()) <span class="kw">BETWEEN</span> exit_qtr.quarter_start_date <span class="kw">and</span> exit_qtr.quarter_end_date</span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> ctePirl.program_name, ctePirl.social_security_number, entry_qtr.Year_Quarter_Key, exit_qtr.Year_Quarter_Key</span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>cteFactData (Person_Key, Program_Key, Enrollment_Year_Quarter_Key, Enrolled_First_Month_of_Quarter,</span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>             Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Person</span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> cteQuarterRange.social_security_number</span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a>                <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> DIM_Program</span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> cteQuarterRange.program_name</span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>            ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key,</span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.min_entry_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Enrolled_First_Month_of_QuarterEntire_Quarter,</span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.min_entry_date) <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.exit_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.max_exit_date) <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> qtr.Year_Quarter_Key <span class="op">=</span> cteQuarterRange.exit_quarter_key <span class="kw">AND</span> DATEPART(<span class="dt">MONTH</span>, cteQuarterRange.max_exit_date) <span class="kw">NOT</span> <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'No'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">CAST</span>(<span class="st">'Yes'</span> <span class="kw">AS</span> <span class="dt">VARCHAR</span>(<span class="dv">3</span>))</span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter</span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteQuarterRange</span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> qtr.Year_Quarter_Key <span class="kw">BETWEEN</span> cteQuarterRange.entry_quarter_key <span class="kw">AND</span> cteQuarterRange.exit_quarter_key</span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  Person_Key,</span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a>        Program_Key,</span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a>        Enrollment_Year_Quarter_Key,</span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> <span class="fu">MAX</span>(Enrolled_First_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> <span class="fu">MAX</span>(Enrolled_Second_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="kw">AND</span> <span class="fu">MAX</span>(Enrolled_Third_Month_of_Quarter) <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_First_Month_of_Quarter),</span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_Second_Month_of_Quarter),</span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MAX</span>(Enrolled_Third_Month_of_Quarter)</span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteFactData</span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> Person_Key, Program_Key, Enrollment_Year_Quarter_Key;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="snap-2" class="level4">
<h4 class="anchored" data-anchor-id="snap-2">SNAP</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">This script will load the FACT Person Quarterly Program Enrollment table with data for the "Supplemental Nutrition Assistance Program (SNAP)" program.</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Find file months were people had enrollments in the source tables (ds_ar_dhs.snap_case, ds_ar_dhs.snap_individual).</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">        The file month's must be within the cert range of an eligible case to be included.</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteFileMonths common table expression (CTE).</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">        File months are mapped to their corresponding quarter and a qtr_month_flag is created to identify which months in the quarter were enrolled.</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The qtr_month_flag is the decimal representation of a binary number where each bit in the binary represents a month.  The first (left most) bit is</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">        used to represent the first month of the quarter and the third (right most) bit is used for the third month.  The results are grouped on person</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">        and quarter and the binary month flags are summed together to create the qtr_month_flag which will have a decimal value between</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">        1 (binary 001) and 7 (binary 111).</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteSNAP CTE which should contain one record for each person and quarter that had an enrollment.</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">        This step looks up the dimension keys for the person and program.  The qtr_month_flag is used to calculate the Enrolled_Entire_Quarter, </span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">        Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, and Enrolled_Third_Month_of_Quarter indicators.  The results will include</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co">        all quarters for each enrollment period a person might have.</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are inserted into the fact table..</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Quarterly Program Enrollment (SNAP)</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Quarterly_Program_Enrollment (Person_Key, Program_Key, Enrollment_Quarter_Key, Enrolled_Entire_Quarter,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>                                                      Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteFileMonths (social_security_number, file_month)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> snap_individual.SSN, snap_case.file_month</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.snap_case</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.snap_individual</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> snap_case.case_unit_id <span class="op">=</span> snap_individual.case_unit_id</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> snap_case.file_month <span class="op">=</span> snap_individual.file_month</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> snap_case.snap_eligibility <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> DATEPART(<span class="dt">YEAR</span>, snap_case.file_month) <span class="op">&gt;=</span> <span class="dv">2010</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_case.file_month <span class="kw">BETWEEN</span> snap_case.cert_start_date <span class="kw">AND</span> snap_case.cert_end_date</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> snap_individual.valid_ssn_format <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>cteSNAP (social_security_number, Enrollment_Quarter_Key, qtr_month_flag)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  cteFileMonths.social_security_number,</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key,</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Decimal representation of a binary flag where the 1st, 2nd, and 3rd month of the quarter are identified as separate bits and added together to create a bitmask.</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Example 1: If only enrolled in the 2nd month of the quarter, then the 2nd bit will be turned on. [010 (binary) equals 2 (decimal)]</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Example 2: If enrolled in the 2nd and 3rd months of the quarter, then the 2nd and 3rd bits will be turned on.  [010 + 100 = 110 (binary) equals 6 (decimal)]</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, cteFileMonths.file_month) <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">10</span>) <span class="cf">THEN</span> <span class="dv">1</span>  <span class="co">--equals 001 binary</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, cteFileMonths.file_month) <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="cf">THEN</span> <span class="dv">2</span>  <span class="co">--equals 010 binary</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> DATEPART(<span class="dt">MONTH</span>, cteFileMonths.file_month) <span class="kw">IN</span> (<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>) <span class="cf">THEN</span> <span class="dv">4</span>  <span class="co">--equals 100 binary</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">END</span>) <span class="kw">AS</span> qtr_month_flag</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteFileMonths</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> cteFileMonths.file_month <span class="kw">BETWEEN</span> qtr.Quarter_Start_Date <span class="kw">and</span> qtr.Quarter_End_Date</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> cteFileMonths.social_security_number, qtr.Year_Quarter_Key</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>            <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>            <span class="kw">FROM</span> DIM_Person</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>            <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> cteSNAP.social_security_number</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>            <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>            <span class="kw">FROM</span> DIM_Program</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>            <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> <span class="st">'Supplemental Nutrition Assistance Program (SNAP)'</span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>        cteSNAP.Enrollment_Quarter_Key,</span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="op">=</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--[001 + 010 + 100 = 111 (binary) equals 7 (decimal)]</span></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the first bit is on, then the 1st month had an enrollment. (001, 011, 101, 111)</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the second bit is on, then the 2nd month had an enrollment. (010, 011, 110, 111)</span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the third bit is on, then the 3rd month had an enrollment. (100, 101, 110, 111)</span></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteSNAP;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tanf-2" class="level4">
<h4 class="anchored" data-anchor-id="tanf-2">TANF</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">This script will load the FACT Person Quarterly Program Enrollment table with data for the "Temporary Assistance for Needy Families (TANF)" program.</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 1</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">        Find reporting months that only have a spell end record.</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Data is returned in the cteSpellEnd common table expression (CTE).</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 2</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Find spell start and end months for each person.  If a record has both the start_of_spell and end_of_spell flags set to true then the entry and exit months</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">        are set to the reporting_month.  If the record only has start_of_spell set to true, then the nearest reporting_month for the same person in cteSpellEnd is used</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">        as the exit month.  Note that if there are two or more overlapping spell ranges with different end months, then one or more of the spells could have the wrong end month.</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are returned in the cteTANFSpell CTE.</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 3</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Reporting months are mapped to their corresponding quarter and a qtr_month_flag is created to identify which months in the quarter were enrolled.</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">        The qtr_month_flag is the decimal representation of a binary number where each bit in the binary represents a month.  The first (left most) bit is</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">        used to represent the first month of the quarter and the third (right most) bit is used for the third month.  The results are grouped on person</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co">        and quarter and the binary month flags are summed together to create the qtr_month_flag which will have a decimal value between</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">        1 (binary 001) and 7 (binary 111).</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">        The results are returned in the cteTANF CTE which should contain one record for each person and quarter that had an enrollment.</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Step 4</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co">        This step looks up the dimension keys for the person and program.  The qtr_month_flag is used to calculate the Enrolled_Entire_Quarter, </span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, and Enrolled_Third_Month_of_Quarter indicators.  The results will include</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">        all quarters for each enrollment period a person might have.</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">        The results of this step are inserted into the fact table..</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person Quarterly Program Enrollment (TANF)</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_Quarterly_Program_Enrollment (Person_Key, Program_Key, Enrollment_Quarter_Key, Enrolled_Entire_Quarter,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                                                      Enrolled_First_Month_of_Quarter, Enrolled_Second_Month_of_Quarter, Enrolled_Third_Month_of_Quarter)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> cteSpellEnd (social_security_number, reporting_month)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">--If the start of spell flag is off and the end of spell flag is on, then the reporting month is when the spell ended.</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">--These end of spell reporting months will be matched to spell starts in the cteTANFSpell query below. </span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> social_security_number, reporting_month</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> tanf_start_of_spell <span class="op">=</span> <span class="st">'FALSE'</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tanf_end_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tanf_member.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>cteTANFSpell (social_security_number, entry_month, exit_month)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- If the start and end of spell flags are both turned on, then the entry and exit months are the reporting month.</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  tm.social_security_number, tm.reporting_month, tm.reporting_month</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member tm</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> tm.tanf_start_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tm.tanf_end_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(tm.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(tm.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> tm.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">UNION</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">--If the start of spell flag is on and the end of spell flag is off, then we have to find the nearest spell end in cteSpellEnd.</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">--</span><span class="al">WARNING</span><span class="co">: If there are two overlapping spells with different end months for the same person, then one of the spells could end up using the wrong end date.</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">--      Example 1: If spell #1 ran from February 2022 thru June 2022 and spell #2 ran from March 2022 thru September 2022 </span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">--                 then spell #1 will be correct but spell #2 will incorrectly end in June 2022 rather than September 2022</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">--                    because June 2022 is the min date that is greater than March 2022.</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">--      Example 2: If spell #1 ran from February 2022 thru September 2022 and spell #2 ran from March 2022 thru June 2022 </span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">--                 then spell #2 will be correct but spell #1 will incorrectly end in June 2022 rather than September 2022</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">--                    because June 2022 is the min date that is greater than March 2022.</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  ts.social_security_number,</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>            ts.reporting_month,</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="fu">MIN</span>(cteSpellEnd.reporting_month) <span class="kw">IS</span> <span class="kw">NULL</span> <span class="cf">THEN</span> <span class="fu">CAST</span>(<span class="st">'999901'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">6</span>))</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">ELSE</span> <span class="fu">MIN</span>(cteSpellEnd.reporting_month)</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member ts</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> cteSpellEnd</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> ts.social_security_number <span class="op">=</span> cteSpellEnd.social_security_number</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> ts.reporting_month <span class="op">&lt;</span> cteSpellEnd.reporting_month</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> ts.tanf_start_of_spell <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ts.tanf_end_of_spell <span class="op">=</span> <span class="st">'FALSE'</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> <span class="kw">LEFT</span>(ts.reporting_month, <span class="dv">4</span>) <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> LEN(ts.reporting_month) <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> ts.valid_ssn_format <span class="op">=</span> <span class="st">'Y'</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> ts.social_security_number, ts.reporting_month</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>cteTANF (social_security_number, Enrollment_Quarter_Key, qtr_month_flag)</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span>  cteTANFSpell.social_security_number,</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>            qtr.Year_Quarter_Key,</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Decimal representation of a binary flag where the 1st, 2nd, and 3rd month of the quarter are identified as separate bits and added together to create a bitmask.</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Example 1: If only enrolled in the 2nd month of the quarter, then the 2nd bit will be turned on. [010 (binary) equals 2 (decimal)]</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>            <span class="co">--Example 2: If enrolled in the 2nd and 3rd months of the quarter, then the 2nd and 3rd bits will be turned on.  [010 + 100 = 110 (binary) equals 6 (decimal)]</span></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUM</span>(<span class="cf">CASE</span> </span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'01'</span>, <span class="st">'04'</span>, <span class="st">'07'</span>, <span class="st">'10'</span>) <span class="cf">THEN</span> <span class="dv">1</span>  <span class="co">--equals 001 binary</span></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'02'</span>, <span class="st">'05'</span>, <span class="st">'08'</span>, <span class="st">'11'</span>) <span class="cf">THEN</span> <span class="dv">2</span>  <span class="co">--equals 010 binary</span></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">WHEN</span> <span class="kw">RIGHT</span>(tanf_member.reporting_month, <span class="dv">2</span>) <span class="kw">IN</span> (<span class="st">'03'</span>, <span class="st">'06'</span>, <span class="st">'09'</span>, <span class="st">'12'</span>) <span class="cf">THEN</span> <span class="dv">4</span>  <span class="co">--equals 100 binary</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">END</span>) <span class="kw">AS</span> qtr_month_flag</span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cteTANFSpell</span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> ds_ar_dhs.tanf_member</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> tanf_member.reporting_month <span class="kw">BETWEEN</span> cteTANFSpell.entry_month <span class="kw">AND</span> cteTANFSpell.exit_month</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ON</span> <span class="fu">TO_DATE</span>(<span class="fu">CONCAT</span>(tanf_member.reporting_month, <span class="fu">CAST</span>(<span class="st">'01'</span> <span class="kw">AS</span> <span class="dt">CHAR</span>(<span class="dv">2</span>))), <span class="st">'YYYYMMDD'</span>) <span class="kw">BETWEEN</span> qtr.Quarter_Start_Date <span class="kw">and</span> qtr.Quarter_End_Date</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">GROUP</span> <span class="kw">BY</span> cteTANFSpell.social_security_number, qtr.Year_Quarter_Key</span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>        <span class="co">--Lookup Person Surrogate Key</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>            <span class="kw">SELECT</span> DIM_Person.Person_Key</span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>            <span class="kw">FROM</span> DIM_Person</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>            <span class="kw">WHERE</span> DIM_Person.Person_UID <span class="op">=</span> cteTANF.social_security_number</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">AS</span> Person_Key,</span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>        <span class="co">--Lookup Program Surrogate Key</span></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>            <span class="kw">SELECT</span> DIM_Program.Program_Key</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>            <span class="kw">FROM</span> DIM_Program</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>            <span class="kw">WHERE</span> DIM_Program.Program_Name <span class="op">=</span> <span class="st">'Temporary Assistance for Needy Families (TANF)'</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">AS</span> Program_Key,</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>        cteTANF.Enrollment_Quarter_Key,</span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="op">=</span> <span class="dv">7</span> <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--[001 + 010 + 100 = 111 (binary) equals 7 (decimal)]</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Entire_Quarter,</span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the first bit is on, then the 1st month had an enrollment. (001, 011, 101, 111)</span></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_First_Month_of_Quarter,</span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the second bit is on, then the 2nd month had an enrollment. (010, 011, 110, 111)</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Second_Month_of_Quarter,</span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">CASE</span></span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">WHEN</span> qtr_month_flag <span class="kw">IN</span> (<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>) <span class="cf">THEN</span> <span class="st">'Yes'</span>  <span class="co">--If the third bit is on, then the 3rd month had an enrollment. (100, 101, 110, 111)</span></span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a>            <span class="cf">ELSE</span> <span class="st">'No'</span></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">END</span> <span class="kw">AS</span> Enrolled_Third_Month_of_Quarter</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cteTANF;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fact-person-ui-wage-table" class="level3">
<h3 class="anchored" data-anchor-id="fact-person-ui-wage-table">FACT Person UI Wage Table</h3>
<section id="ui-wage" class="level4">
<h4 class="anchored" data-anchor-id="ui-wage">UI Wage</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- FACT Person UI Wage</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> FACT_Person_UI_Wage (Person_Key, Year_Quarter_Key, UI_Quarterly_Wages)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> p.Person_Key, qtr.Year_Quarter_Key, <span class="fu">sum</span>(lehd.employee_wage_amount)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dws.ui_wages_lehd lehd</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Person p</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> lehd.employee_ssn <span class="op">=</span> p.Person_UID</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Year_Quarter qtr</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> lehd.reporting_period_year <span class="op">=</span> qtr.Calendar_Year</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> lehd.reporting_period_quarter <span class="op">=</span> qtr.Calendar_Quarter</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> lehd.reporting_period_year <span class="op">&gt;=</span> <span class="st">'2010'</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> p.Person_Key, qtr.Year_Quarter_Key;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="dimension-tables" class="level3">
<h3 class="anchored" data-anchor-id="dimension-tables">Dimension Tables</h3>
<section id="dim-cip" class="level4">
<h4 class="anchored" data-anchor-id="dim-cip">DIM CIP</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "REDACTED" CIP dimension record (ONLY RUN ONCE)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">INSERT INTO DIM_CIP (CIP_Key, Classification_Code, Classification_Name, Category_Name,</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">                     Series_Name, Series_Short_Name, Major_Group_Code, Major_Group_Name)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (REDACTED, 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED');</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new CIP code dimension records</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_CIP (CIP_Key, Classification_Code, Classification_Name, Category_Name,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                     Series_Name, Series_Short_Name, Major_Group_Code, Major_Group_Name)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.CIP_ID, mdm.Classification_Code, mdm.Classification_Name, mdm.Category_Name,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        mdm.Series_Name, mdm.Series_Short_Name, mdm.Major_Group_Code, mdm.Major_Group_Name</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_CIP mdm</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_CIP dim</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.CIP_ID <span class="op">=</span> dim.CIP_Key</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.CIP_Key <span class="kw">IS</span> <span class="kw">NULL</span>;</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- Update changed CIP code dimension records</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> DIM_CIP</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> Classification_Name <span class="op">=</span> mdm.Classification_Name</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    Category_Name <span class="op">=</span> mdm.Category_Name</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    Series_Name <span class="op">=</span> mdm.Series_Name</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    Series_Short_Name <span class="op">=</span> mdm.Series_Short_Name</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    Major_Group_Code <span class="op">=</span> mdm.Major_Group_Code</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    Major_Group_Name <span class="op">=</span> mdm.Major_Group_Name</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_CIP mdm</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_CIP dim</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.CIP_ID <span class="op">=</span> dim.CIP_Key</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> mdm.Classification_Name <span class="op">&lt;&gt;</span> dim.Classification_Name</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Category_Name <span class="op">&lt;&gt;</span> dim.Category_Name</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Series_Name <span class="op">&lt;&gt;</span> dim.Series_Name</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Series_Short_Name <span class="op">&lt;&gt;</span> dim.Series_Short_Name</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Major_Group_Code <span class="op">&lt;&gt;</span> dim.Major_Group_Code</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Major_Group_Name <span class="op">&lt;&gt;</span> dim.Major_Group_Name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-country" class="level4">
<h4 class="anchored" data-anchor-id="dim-country">DIM COUNTRY</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "REDACTED" county dimension record (ONLY RUN ONCE)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">INSERT INTO DIM_County (County_Key, County_FIPS_Code, County_Name, Rural_Urban_Continuum, Local_Workforce_Development_Area)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (REDACTED, 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED');</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new county dimension records</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_County (County_Key, County_FIPS_Code, County_Name, Rural_Urban_Continuum, Local_Workforce_Development_Area)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.County_ID,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        mdm.County_FIPS_Code,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        mdm.County_Name,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        mdm.Rural_Urban_Continuum,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        mdm.Local_Workforce_Development_Area</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_County mdm</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_County dim</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.County_ID <span class="op">=</span> dim.County_Key</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.County_KEY <span class="kw">IS</span> <span class="kw">NULL</span>;</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- Update changed county dimension records</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> DIM_County</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> County_Name <span class="op">=</span> county.name,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    Rural_Urban_Continuum <span class="op">=</span> ruc.name,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    Local_Workforce_Development_Area <span class="op">=</span> county.local_workforce_development_area</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_County mdm</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_County dim</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.County_ID <span class="op">=</span> dim.County_Key</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> mdm.County_Name <span class="op">&lt;&gt;</span> dim.County_Name</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Rural_Urban_Continuum <span class="op">&lt;&gt;</span> dim.Rural_Urban_Continuum</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> mdm.Local_Workforce_Development_Area <span class="op">&lt;&gt;</span> dim.Local_Workforce_Development_Area;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-intake-characteristics" class="level4">
<h4 class="anchored" data-anchor-id="dim-intake-characteristics">DIM Intake Characteristics</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "REDACTED" Intake Characteristics dimension record (ONLY RUN ONCE)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">INSERT INTO DIM_Intake_Characteristics (Intake_Characteristics_Key, Highest_School_Grade_Completed_at_Program_Entry,</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">                                Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">                                Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry,</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">                                Exhausting_TANF_Within_2_Yrs_at_Program_Entry, Foster_Care_Youth_Status_at_Program_Entry,</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">                                Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry, Low_Income_Status_at_Program_Entry,</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">                                English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">                                Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry)</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (REDACTED, 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED');</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new Intake Characteristics records</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_Intake_Characteristics (Intake_Characteristics_Key, Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                                Highest_Education_Level_Completed_at_Program_Entry, School_Status_at_Program_Entry,</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                                Employment_Status_at_Program_Entry, Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>                                Exhausting_TANF_Within_2_Yrs_at_Program_Entry, Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                                Homeless_or_Runaway_at_Program_Entry, Ex_Offender_Status_at_Program_Entry, Low_Income_Status_at_Program_Entry,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                                English_Language_Learner_at_Program_Entry, Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                                Cultural_Barriers_at_Program_Entry, Single_Parent_at_Program_Entry, Displaced_Homemaker_at_Program_Entry)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.Intake_Characteristics_Master_ID,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        mdm.Highest_School_Grade_Completed_at_Program_Entry,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        mdm.Highest_Education_Level_Completed_at_Program_Entry,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        mdm.School_Status_at_Program_Entry,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        mdm.Employment_Status_at_Program_Entry,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>        mdm.Long_Term_Unemployment_at_Program_Entry,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>        mdm.Exhausting_TANF_Within_2_Yrs_at_Program_Entry,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        mdm.Foster_Care_Youth_Status_at_Program_Entry,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        mdm.Homeless_or_Runaway_at_Program_Entry,</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>        mdm.Ex_Offender_Status_at_Program_Entry,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        mdm.Low_Income_Status_at_Program_Entry,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>        mdm.English_Language_Learner_at_Program_Entry,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>        mdm.Low_Levels_of_Literacy_at_Program_Entry,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        mdm.Cultural_Barriers_at_Program_Entry,</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>        mdm.Single_Parent_at_Program_Entry,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>        mdm.Displaced_Homemaker_at_Program_Entry</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_Intake_Characteristics_Master mdm</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_Intake_Characteristics dim</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.Intake_Characteristics_Master_ID <span class="op">=</span> dim.Intake_Characteristics_Key</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.Intake_Characteristics_Key <span class="kw">IS</span> <span class="kw">NULL</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> <span class="kw">NOT</span>(mdm.Highest_School_Grade_Completed_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Highest_Education_Level_Completed_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.School_Status_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Employment_Status_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Long_Term_Unemployment_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Exhausting_TANF_Within_2_Yrs_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Foster_Care_Youth_Status_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Homeless_or_Runaway_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Ex_Offender_Status_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Low_Income_Status_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.English_Language_Learner_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Low_Levels_of_Literacy_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Cultural_Barriers_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Single_Parent_at_Program_Entry <span class="op">=</span> <span class="st">''</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> mdm.Displaced_Homemaker_at_Program_Entry <span class="op">=</span> <span class="st">''</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-person" class="level4">
<h4 class="anchored" data-anchor-id="dim-person">DIM Person</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "blank" person dimension record (ONLY RUN ONCE)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">INSERT INTO DIM_Person (Person_Key, Person_UID, Date_of_Birth, Gender, Ethnicity_American_Indian_or_Alaska_Native,</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">                              Ethnicity_Asian, Ethnicity_Black_or_African_American, Ethnicity_Hispanic_or_Latino,</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">                              Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander, Ethnicity_White, Ethnicity_Other)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (REDACTED, 'REDACTED', CAST('9999-01-01' AS DATE), 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED', 'REDACTED');</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new person dimension records</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_Person (Person_Key, Person_UID, Date_of_Birth, Gender, Ethnicity_American_Indian_or_Alaska_Native,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                   Ethnicity_Asian, Ethnicity_Black_or_African_American, Ethnicity_Hispanic_or_Latino,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                   Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander, Ethnicity_White, Ethnicity_Other)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.Person_Master_ID,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        mdm.Person_UID,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        mdm.Date_of_Birth,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        mdm.Gender,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_American_Indian_or_Alaska_Native,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_Asian,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_Black_or_African_American,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_Hispanic_or_Latino,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_White,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>        mdm.Ethnicity_Other</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_Person_Master mdm</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_Person dim</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.Person_Master_ID <span class="op">=</span> dim.Person_Key</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.Person_Key <span class="kw">IS</span> <span class="kw">NULL</span>;</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="co">-- Update changed person dimension records</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> DIM_Person</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> Date_of_Birth <span class="op">=</span> mdm.Date_of_Birth,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    Gender <span class="op">=</span> mdm.Gender,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    Ethnicity_American_Indian_or_Alaska_Native <span class="op">=</span> mdm.Ethnicity_American_Indian_or_Alaska_Native,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    Ethnicity_Asian <span class="op">=</span> mdm.Ethnicity_Asian,</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    Ethnicity_Black_or_African_American <span class="op">=</span> mdm.Ethnicity_Black_or_African_American,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    Ethnicity_Hispanic_or_Latino <span class="op">=</span> mdm.Ethnicity_Hispanic_or_Latino,</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander <span class="op">=</span> mdm.Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander,</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>    Ethnicity_White <span class="op">=</span> mdm.Ethnicity_White,</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    Ethnicity_Other <span class="op">=</span> mdm.Ethnicity_Other</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_Person_Master mdm</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> DIM_Person dim</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.Person_Master_ID <span class="op">=</span> dim.Person_Key</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> (dim.Date_of_Birth <span class="op">&lt;&gt;</span> mdm.Date_of_Birth</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Gender <span class="op">&lt;&gt;</span> mdm.Gender</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_American_Indian_or_Alaska_Native <span class="op">&lt;&gt;</span> mdm.Ethnicity_American_Indian_or_Alaska_Native</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_Asian <span class="op">&lt;&gt;</span> mdm.Ethnicity_Asian</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_Black_or_African_American <span class="op">&lt;&gt;</span> mdm.Ethnicity_Black_or_African_American</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_Hispanic_or_Latino <span class="op">&lt;&gt;</span> mdm.Ethnicity_Hispanic_or_Latino</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander <span class="op">&lt;&gt;</span> mdm.Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_White <span class="op">&lt;&gt;</span> mdm.Ethnicity_White</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">OR</span> dim.Ethnicity_Other <span class="op">&lt;&gt;</span> mdm.Ethnicity_Other);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-program" class="level4">
<h4 class="anchored" data-anchor-id="dim-program">DIM Program</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new program dimension records</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_Program (Program_Key, Program_Name)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.Program_ID,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>        mdm.Program_Name</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_Program mdm</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_Program dim</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.Program_ID <span class="op">=</span> dim.Program_Key</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.Program_Key <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-state" class="level4">
<h4 class="anchored" data-anchor-id="dim-state">DIM State</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "blank" State dimension record (ONLY RUN ONCE)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">INSERT INTO DIM_State (State_Key, State_FIPS_Code, State_Abbreviation, State_Name)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (0, '', '', '');</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_State (State_Key, State_FIPS_Code, State_Abbreviation, State_Name)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> mdm.State_ID, mdm.State_FIPS_Code, mdm.State_Abbreviation, mdm.State_Name</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_State mdm</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_State dim</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.State_ID <span class="op">=</span> dim.State_Key</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.State_Key <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dim-year-quarter" class="level4">
<h4 class="anchored" data-anchor-id="dim-year-quarter">DIM Year Quarter</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add new year/quarter dimension records</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> DIM_Year_Quarter (Year_Quarter_Key, Calendar_Year, Calendar_Quarter, Quarter_Start_Date, Quarter_End_Date)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  mdm.Year_Quarter_ID,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        mdm.Calendar_Year,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        mdm.Calendar_Quarter,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        mdm.Quarter_Start_Date,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>        mdm.Quarter_End_Date</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> MDM_Year_Quarter mdm</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> DIM_Year_Quarter dim</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> mdm.Year_Quarter_ID <span class="op">=</span> dim.Year_Quarter_Key</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> dim.Year_Quarter_Key <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mdm-person-instance" class="level4">
<h4 class="anchored" data-anchor-id="mdm-person-instance">MDM Person Instance</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (SNAP)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ssn, <span class="fu">NVL2</span>(dob, dob, <span class="st">'1900-01-01'</span>), </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>       <span class="cf">case</span> sex <span class="cf">when</span> <span class="st">'M'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'F'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'99'</span> <span class="cf">then</span> <span class="st">'Missing'</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_aian </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_asian </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_black </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> hispanic </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_nhpi</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_white </span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race_other </span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'99'</span> <span class="cf">THEN</span> <span class="st">'MI'</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'88'</span> <span class="cf">then</span> <span class="st">'NC'</span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SNAP'</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dhs.snap_individual;</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (Graduated Student)</span></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ssn_id, <span class="st">'1900-01-01'</span>, </span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>       <span class="cf">case</span> gender <span class="cf">when</span> <span class="st">'M'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'F'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> amerind </span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> asian </span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> black </span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> hispanic </span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> hawaiian</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> white </span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, <span class="st">'N/A'</span>,</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Graduated STudent'</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dhe.graduated_student_table;</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (Registration table)</span></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ssn_id, <span class="st">'1900-01-01'</span>, <span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">'Student Registration'</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dhe.registration_table;</span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (UI Wages LEHD table)</span></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> employee_ssn, <span class="st">'1900-01-01'</span>, <span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="st">'UI Wages LEHD'</span></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dws.ui_wages_lehd;</span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (Student Enrollment table)</span></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ssn_id, (<span class="fu">to_date</span>(<span class="fu">nvl2</span>(date_of_birth, date_of_birth, <span class="st">'1900-01-01'</span>), <span class="st">'MMDDYYYY'</span>)), </span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> gender <span class="cf">when</span> <span class="st">'M'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'F'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'O'</span> <span class="cf">then</span> <span class="st">'Other'</span></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> amerind </span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> asian </span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> black </span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> hispanic </span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> hawaiian</span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> white </span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'Y'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'N'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, <span class="st">'N/A'</span>,<span class="st">'Student Enrollment'</span></span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> ds_ar_dhe.student_enrollment_table;</span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (PIRL table)</span></span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> social_security_number,<span class="fu">nvl2</span>(date_of_birth_wioa, date_of_birth_wioa, <span class="st">'1900-01-01'</span>), </span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> sex_wioa <span class="cf">when</span> <span class="st">'1'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'2'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> american_indian_alaska_native_wioa</span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> asian_wioa</span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> black_african_american_wioa</span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_hispanic_latino_wioa </span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> native_hawaiian_other_pacific_islander_wioa</span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> white_wioa</span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, <span class="st">'N/A'</span>,<span class="st">'PIRL'</span></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.pirl;</span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (PROMIS table)</span></span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> ssn, <span class="fu">to_date</span>(<span class="fu">nvl2</span>(birth_date, birth_date, <span class="st">'1900-01-01'</span>), <span class="st">'YYYYMMDD'</span>), </span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> gender <span class="cf">when</span> <span class="st">'1'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'2'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'6'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> race <span class="cf">when</span> <span class="st">'4'</span> <span class="cf">then</span> <span class="st">'Yes'</span></span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a>              <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race  <span class="cf">WHEN</span> <span class="st">'3'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-239"><a href="#cb47-239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-240"><a href="#cb47-240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race</span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity </span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race</span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'5'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> race</span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, </span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> race </span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'6'</span> <span class="cf">then</span> <span class="st">'2+'</span></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,<span class="st">'PROMIS'</span></span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.promis ;</span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (TANF table)</span></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> social_security_number, <span class="fu">nvl2</span>(date_of_birth , date_of_birth , <span class="st">'1900-01-01'</span>), </span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> gender <span class="cf">when</span> <span class="st">'1'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'2'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'3'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_american_indian_alaska_native</span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_asian</span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_black_african_american </span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_hispanic_latino</span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_native_hawaiian_pacific_islander</span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-299"><a href="#cb47-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-300"><a href="#cb47-300" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_white</span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, </span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N/A'</span>,<span class="st">'TANF'</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dhs.tanf_member  ;</span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (Joint PIRL table)</span></span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">NVL2</span>(social_security_number, social_security_number, <span class="st">''</span> ),<span class="fu">nvl2</span>(date_of_birth_wioa, date_of_birth_wioa, <span class="st">'1900-01-01'</span>), </span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> sex_wioa <span class="cf">when</span> <span class="st">'1'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'2'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'3'</span> <span class="cf">then</span> <span class="st">''</span></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> american_indian_alaska_native_wioa</span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> asian_wioa</span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> black_african_american_wioa</span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicity_hispanic_latino_wioa </span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> native_hawaiian_other_pacific_islander_wioa</span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> white_wioa</span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, <span class="st">'N/A'</span>,<span class="st">'Joint PIRL'</span></span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_dws.jointpirl_raw_data;</span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-347"><a href="#cb47-347" aria-hidden="true" tabindex="-1"></a><span class="co">-- Person Instance (Rapids Apprentice table)</span></span>
<span id="cb47-348"><a href="#cb47-348" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_instance (person_uid, date_of_birth, gender, </span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, data_source)</span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">nvl2</span>(ssn, ssn, <span class="st">''</span>),<span class="fu">nvl2</span>(dob, dob, <span class="st">'1900-01-01'</span>), </span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> gender <span class="cf">when</span> <span class="st">'M'</span> <span class="cf">then</span> <span class="st">'Male'</span></span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'F'</span> <span class="cf">then</span> <span class="st">'Female'</span></span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a>                <span class="cf">when</span> <span class="st">'U'</span> <span class="cf">then</span> <span class="st">'Unknown'</span></span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span>,</span>
<span id="cb47-359"><a href="#cb47-359" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> natindianind</span>
<span id="cb47-360"><a href="#cb47-360" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-361"><a href="#cb47-361" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-362"><a href="#cb47-362" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> asianind</span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-371"><a href="#cb47-371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> africaamerind</span>
<span id="cb47-372"><a href="#cb47-372" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-375"><a href="#cb47-375" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-376"><a href="#cb47-376" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> ethnicind </span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'2'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-381"><a href="#cb47-381" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-382"><a href="#cb47-382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-383"><a href="#cb47-383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> nathawaiind</span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>,</span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">CASE</span> wind</span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'1'</span> <span class="cf">THEN</span> <span class="st">'Yes'</span></span>
<span id="cb47-391"><a href="#cb47-391" aria-hidden="true" tabindex="-1"></a>        <span class="cf">WHEN</span> <span class="st">'0'</span> <span class="cf">THEN</span> <span class="st">'No'</span></span>
<span id="cb47-392"><a href="#cb47-392" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> <span class="st">'9'</span> <span class="cf">then</span> <span class="st">'UK'</span></span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="st">''</span></span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span>, <span class="st">'N/A'</span>,<span class="st">'RAPIDS Apprentice'</span></span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> ds_ar_osd.rapids_apprentice ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mdm-person-master" class="level4">
<h4 class="anchored" data-anchor-id="mdm-person-master">MDM Person Master</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">--Person Master Load</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> tr_ar_wdqi_2023.mdm_person_master (person_uid, date_of_birth, gender, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> person_uid, date_of_birth, gender, </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>                                                 ethnicity_other, </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> person_instance_id) <span class="kw">as</span> RowNbr </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> tr_ar_wdqi_2023.mdm_person_instance</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>) mpi</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> RowNbr <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">--To verify the count of records</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>(<span class="kw">select</span> ssn_id  <span class="kw">from</span> ds_ar_dhe.graduated_student_table gst </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ssn_id  <span class="kw">from</span> ds_ar_dhe.registration_table rt </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ssn_id  <span class="kw">from</span> ds_ar_dhe.student_enrollment_table set2 </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ssn <span class="kw">from</span> ds_ar_dhs.snap_individual si </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> social_security_number <span class="kw">from</span> ds_ar_dhs.tanf_member tm </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> social_security_number <span class="kw">from</span> ds_ar_dws.jointpirl_raw_data jrd </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> social_security_number <span class="kw">from</span> ds_ar_dws.pirl p </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ssn <span class="kw">from</span> ds_ar_dws.promis p2 </span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> employee_ssn <span class="kw">from</span> ds_ar_dws.ui_wages_lehd uwl </span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> ssn <span class="kw">from</span> ds_ar_osd.rapids_apprentice ra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mdm-person-traceability" class="level4">
<h4 class="anchored" data-anchor-id="mdm-person-traceability">MDM Person Traceability</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">Into</span> tr_ar_wdqi_2023.mdm_person_traceability ( person_master_id, person_field_id, person_instance_id)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> mpm.person_master_id, <span class="st">'1'</span> , mpi.person_instance_id  </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> tr_ar_wdqi_2023.mdm_person_master mpm </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">join</span> tr_ar_wdqi_2023.mdm_person_instance mpi </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="kw">on</span> mpm.person_uid <span class="op">=</span> mpi.person_uid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="person-master---updated" class="level4">
<h4 class="anchored" data-anchor-id="person-master---updated">Person Master - Updated</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> person_uid, date_of_birth, gender, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         ethnicity_american_indian_or_alaska_native, ethnicity_asian,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         ethnicity_black_or_african_american, ethnicity_hispanic_or_latino,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         ethnicity_native_hawaiian_or_other_pacific_islander, ethnicity_white,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         ethnicity_other, (<span class="cf">case</span> <span class="cf">when</span> ((ethnicity_american_indian_or_alaska_native <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_american_indian_or_alaska_native <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_asian <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_asian <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_black_or_african_american <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_black_or_african_american <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_hispanic_or_latino <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_hispanic_or_latino <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_native_hawaiian_or_other_pacific_islander <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_native_hawaiian_or_other_pacific_islander <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_white <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_white <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                                <span class="op">+</span> <span class="cf">case</span> <span class="cf">when</span> ((ethnicity_other <span class="op">=</span> <span class="st">'Yes'</span>) <span class="kw">or</span> (ethnicity_other <span class="op">=</span> <span class="st">'No'</span>)) <span class="cf">then</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">end</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="kw">as</span> CountOfNonNulls,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> CountOfNonNulls <span class="kw">desc</span>) <span class="kw">as</span> RowNbr </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> tr_e2e.mdm_person_instance</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>) mpi</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> RowNbr <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="person_mastering" class="level4">
<h4 class="anchored" data-anchor-id="person_mastering">person_mastering</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> tr_e2e.DIM_Person (</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>   Person_UID <span class="dt">CHAR</span>(<span class="dv">64</span>) <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>   Date_of_Birth <span class="dt">DATE</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>   Gender <span class="dt">VARCHAR</span>(<span class="dv">10</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>   Ethnicity_American_Indian_or_Alaska_Native <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Asian <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Black_or_African_American <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Hispanic_or_Latino <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>   Ethnicity_White <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>   Ethnicity_Other <span class="dt">VARCHAR</span>(<span class="dv">3</span>),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> DIM_PERSON_PK_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Key),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_UID)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">REFERENCES</span> <span class="kw">ON</span> <span class="kw">TABLE</span> tr_e2e.DIM_Person <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">REFERENCES</span> <span class="kw">ON</span> <span class="kw">TABLE</span> tr_e2e.DIM_Person <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- Add "blank" person dimension record (ONLY RUN ONCE)</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">/*INSERT INTO tr_e2e.DIM_Person (Person_Key, Person_UID, Date_of_Birth, Gender, Ethnicity_American_Indian_or_Alaska_Native,</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">                              Ethnicity_Asian, Ethnicity_Black_or_African_American, Ethnicity_Hispanic_or_Latino,</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">                              Ethnicity_Native_Hawaiian_or_Other_Pacific_Islander, Ethnicity_White, Ethnicity_Other)</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">VALUES (REDACTED, '', CAST('9999-01-01' AS DATE), REDACTED, REDACTED, REDACTED, REDACTED, REDACTED, REDACTED, REDACTED, REDACTED); */</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> tr_e2e.dim_person( </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    person_key,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    person_uid, </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    gender, </span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    date_of_birth, </span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    ethnicity_asian,</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    ethnicity_black_or_african_american,</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    ethnicity_hispanic_or_latino,</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    ethnicity_native_hawaiian_or_other_pacific_islander,</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>    ethnicity_white,</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    ethnicity_other</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> gender_tab <span class="kw">as</span> (</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, gender, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>,</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">--breaking ties when highest count is same for multiple gender values </span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in future, would prefer to break tie by recency of observation, but not tracked in person_instance </span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="cf">when</span> gender <span class="op">=</span> <span class="st">'Other'</span> <span class="cf">then</span> <span class="dv">1</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> gender <span class="op">=</span> <span class="st">'Female'</span> <span class="cf">then</span> <span class="dv">2</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">when</span> gender <span class="op">=</span> <span class="st">'Male'</span> <span class="cf">then</span> <span class="dv">3</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="dv">4</span> <span class="cf">end</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">as</span> rn </span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> gender <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'Unknown'</span>, <span class="st">'Missing'</span>)</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, gender</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>gender_tab2 <span class="kw">as</span> (</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> </span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gender_tab </span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>dob_tab <span class="kw">as</span> (</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, date_of_birth, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, order by date of birth </span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, date_of_birth) <span class="kw">as</span> rn </span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> date_of_birth <span class="op">!=</span> <span class="st">'1900-01-01'</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, date_of_birth </span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>dob_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> </span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> dob_tab </span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>eth_aian_tab <span class="kw">as</span> (</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_american_indian_or_alaska_native, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes over no </span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_american_indian_or_alaska_native <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_american_indian_or_alaska_native <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_american_indian_or_alaska_native <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_american_indian_or_alaska_native </span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>eth_aian_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> </span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_aian_tab </span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a>eth_asian_tab <span class="kw">as</span> (</span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_asian, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes over no </span></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_asian <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_asian <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_asian <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_asian  </span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a>eth_asian_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_asian_tab </span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-103"><a href="#cb51-103" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-104"><a href="#cb51-104" aria-hidden="true" tabindex="-1"></a>eth_baa_tab <span class="kw">as</span> (</span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_black_or_african_american, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes over no </span></span>
<span id="cb51-107"><a href="#cb51-107" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-108"><a href="#cb51-108" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_black_or_african_american <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-109"><a href="#cb51-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_black_or_african_american <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-110"><a href="#cb51-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-111"><a href="#cb51-111" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-112"><a href="#cb51-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-113"><a href="#cb51-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_asian <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-114"><a href="#cb51-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_black_or_african_american  </span>
<span id="cb51-115"><a href="#cb51-115" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-116"><a href="#cb51-116" aria-hidden="true" tabindex="-1"></a>eth_baa_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-117"><a href="#cb51-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> </span>
<span id="cb51-118"><a href="#cb51-118" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_baa_tab </span>
<span id="cb51-119"><a href="#cb51-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-120"><a href="#cb51-120" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-121"><a href="#cb51-121" aria-hidden="true" tabindex="-1"></a>eth_hl_tab <span class="kw">as</span> (</span>
<span id="cb51-122"><a href="#cb51-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_hispanic_or_latino, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-123"><a href="#cb51-123" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes or no </span></span>
<span id="cb51-124"><a href="#cb51-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-125"><a href="#cb51-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_hispanic_or_latino <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-126"><a href="#cb51-126" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_hispanic_or_latino <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-127"><a href="#cb51-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-128"><a href="#cb51-128" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-129"><a href="#cb51-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-130"><a href="#cb51-130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_hispanic_or_latino <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-131"><a href="#cb51-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_hispanic_or_latino </span>
<span id="cb51-132"><a href="#cb51-132" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-133"><a href="#cb51-133" aria-hidden="true" tabindex="-1"></a>eth_hl_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-134"><a href="#cb51-134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb51-135"><a href="#cb51-135" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_hl_tab </span>
<span id="cb51-136"><a href="#cb51-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-137"><a href="#cb51-137" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-138"><a href="#cb51-138" aria-hidden="true" tabindex="-1"></a>eth_nhpi_tab <span class="kw">as</span> (</span>
<span id="cb51-139"><a href="#cb51-139" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_native_hawaiian_or_other_pacific_islander, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-140"><a href="#cb51-140" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes or no</span></span>
<span id="cb51-141"><a href="#cb51-141" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-142"><a href="#cb51-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_native_hawaiian_or_other_pacific_islander <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-143"><a href="#cb51-143" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_native_hawaiian_or_other_pacific_islander <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-144"><a href="#cb51-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-145"><a href="#cb51-145" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-146"><a href="#cb51-146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-147"><a href="#cb51-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_native_hawaiian_or_other_pacific_islander <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-148"><a href="#cb51-148" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_native_hawaiian_or_other_pacific_islander </span>
<span id="cb51-149"><a href="#cb51-149" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-150"><a href="#cb51-150" aria-hidden="true" tabindex="-1"></a>eth_nhpi_tab2 <span class="kw">as</span> ( </span>
<span id="cb51-151"><a href="#cb51-151" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb51-152"><a href="#cb51-152" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_nhpi_tab </span>
<span id="cb51-153"><a href="#cb51-153" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-154"><a href="#cb51-154" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-155"><a href="#cb51-155" aria-hidden="true" tabindex="-1"></a>eth_white_tab <span class="kw">as</span> (</span>
<span id="cb51-156"><a href="#cb51-156" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_white, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-157"><a href="#cb51-157" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes or no </span></span>
<span id="cb51-158"><a href="#cb51-158" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-159"><a href="#cb51-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_white <span class="op">=</span> <span class="st">'Yes'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-160"><a href="#cb51-160" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_white <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-161"><a href="#cb51-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-162"><a href="#cb51-162" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-163"><a href="#cb51-163" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-164"><a href="#cb51-164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_white <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'MI'</span>, <span class="st">'UK'</span>)</span>
<span id="cb51-165"><a href="#cb51-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_white  </span>
<span id="cb51-166"><a href="#cb51-166" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-167"><a href="#cb51-167" aria-hidden="true" tabindex="-1"></a>eth_white_tab2 <span class="kw">as</span> (</span>
<span id="cb51-168"><a href="#cb51-168" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span> </span>
<span id="cb51-169"><a href="#cb51-169" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_white_tab </span>
<span id="cb51-170"><a href="#cb51-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-171"><a href="#cb51-171" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-172"><a href="#cb51-172" aria-hidden="true" tabindex="-1"></a>eth_other_tab <span class="kw">as</span> ( </span>
<span id="cb51-173"><a href="#cb51-173" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_other, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-174"><a href="#cb51-174" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, prioritize yes or no </span></span>
<span id="cb51-175"><a href="#cb51-175" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-176"><a href="#cb51-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_other <span class="op">=</span> <span class="st">'2+'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-177"><a href="#cb51-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_other <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-178"><a href="#cb51-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-179"><a href="#cb51-179" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-180"><a href="#cb51-180" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-181"><a href="#cb51-181" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_other <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'NC'</span>, <span class="st">'N/A'</span>)</span>
<span id="cb51-182"><a href="#cb51-182" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_other</span>
<span id="cb51-183"><a href="#cb51-183" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-184"><a href="#cb51-184" aria-hidden="true" tabindex="-1"></a>eth_other_tab2 <span class="kw">as</span> (</span>
<span id="cb51-185"><a href="#cb51-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="op">*</span></span>
<span id="cb51-186"><a href="#cb51-186" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_other_tab </span>
<span id="cb51-187"><a href="#cb51-187" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> rn <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-188"><a href="#cb51-188" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-189"><a href="#cb51-189" aria-hidden="true" tabindex="-1"></a>unique_ppl <span class="kw">as</span> (</span>
<span id="cb51-190"><a href="#cb51-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="kw">distinct</span> person_uid </span>
<span id="cb51-191"><a href="#cb51-191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi2 </span>
<span id="cb51-192"><a href="#cb51-192" aria-hidden="true" tabindex="-1"></a>), </span>
<span id="cb51-193"><a href="#cb51-193" aria-hidden="true" tabindex="-1"></a>gd <span class="kw">as</span> (</span>
<span id="cb51-194"><a href="#cb51-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(gt.person_uid, dt.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-195"><a href="#cb51-195" aria-hidden="true" tabindex="-1"></a>        gt.gender,</span>
<span id="cb51-196"><a href="#cb51-196" aria-hidden="true" tabindex="-1"></a>        dt.date_of_birth</span>
<span id="cb51-197"><a href="#cb51-197" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gender_tab2 gt </span>
<span id="cb51-198"><a href="#cb51-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> dob_tab2 dt <span class="kw">on</span> (gt.person_uid <span class="op">=</span> dt.person_uid)</span>
<span id="cb51-199"><a href="#cb51-199" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-200"><a href="#cb51-200" aria-hidden="true" tabindex="-1"></a>gda <span class="kw">as</span> (</span>
<span id="cb51-201"><a href="#cb51-201" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(eat.person_uid, gd.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-202"><a href="#cb51-202" aria-hidden="true" tabindex="-1"></a>    gd.gender, </span>
<span id="cb51-203"><a href="#cb51-203" aria-hidden="true" tabindex="-1"></a>    gd.date_of_birth, </span>
<span id="cb51-204"><a href="#cb51-204" aria-hidden="true" tabindex="-1"></a>    eat.ethnicity_american_indian_or_alaska_native </span>
<span id="cb51-205"><a href="#cb51-205" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_aian_tab2 eat</span>
<span id="cb51-206"><a href="#cb51-206" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> gd <span class="kw">on</span> gd.person_uid <span class="op">=</span> eat.person_uid</span>
<span id="cb51-207"><a href="#cb51-207" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-208"><a href="#cb51-208" aria-hidden="true" tabindex="-1"></a>gdaa <span class="kw">as</span> (</span>
<span id="cb51-209"><a href="#cb51-209" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(east.person_uid, gda.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-210"><a href="#cb51-210" aria-hidden="true" tabindex="-1"></a>    gda.gender, </span>
<span id="cb51-211"><a href="#cb51-211" aria-hidden="true" tabindex="-1"></a>    gda.date_of_birth, </span>
<span id="cb51-212"><a href="#cb51-212" aria-hidden="true" tabindex="-1"></a>    gda.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-213"><a href="#cb51-213" aria-hidden="true" tabindex="-1"></a>    east.ethnicity_asian</span>
<span id="cb51-214"><a href="#cb51-214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> eth_asian_tab2 east</span>
<span id="cb51-215"><a href="#cb51-215" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> gda <span class="kw">on</span> gda.person_uid <span class="op">=</span> east.person_uid</span>
<span id="cb51-216"><a href="#cb51-216" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-217"><a href="#cb51-217" aria-hidden="true" tabindex="-1"></a>gdaab <span class="kw">as</span> (</span>
<span id="cb51-218"><a href="#cb51-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(ebt.person_uid, gdaa.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-219"><a href="#cb51-219" aria-hidden="true" tabindex="-1"></a>    gdaa.gender, </span>
<span id="cb51-220"><a href="#cb51-220" aria-hidden="true" tabindex="-1"></a>    gdaa.date_of_birth, </span>
<span id="cb51-221"><a href="#cb51-221" aria-hidden="true" tabindex="-1"></a>    gdaa.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-222"><a href="#cb51-222" aria-hidden="true" tabindex="-1"></a>    gdaa.ethnicity_asian,</span>
<span id="cb51-223"><a href="#cb51-223" aria-hidden="true" tabindex="-1"></a>    ebt.ethnicity_black_or_african_american</span>
<span id="cb51-224"><a href="#cb51-224" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaa </span>
<span id="cb51-225"><a href="#cb51-225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> eth_baa_tab2 ebt <span class="kw">on</span> (gdaa.person_uid <span class="op">=</span> ebt.person_uid)</span>
<span id="cb51-226"><a href="#cb51-226" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-227"><a href="#cb51-227" aria-hidden="true" tabindex="-1"></a>gdaabh <span class="kw">as</span> (</span>
<span id="cb51-228"><a href="#cb51-228" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(eht.person_uid, gdaab.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-229"><a href="#cb51-229" aria-hidden="true" tabindex="-1"></a>    gdaab.gender, </span>
<span id="cb51-230"><a href="#cb51-230" aria-hidden="true" tabindex="-1"></a>    gdaab.date_of_birth, </span>
<span id="cb51-231"><a href="#cb51-231" aria-hidden="true" tabindex="-1"></a>    gdaab.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-232"><a href="#cb51-232" aria-hidden="true" tabindex="-1"></a>    gdaab.ethnicity_asian,</span>
<span id="cb51-233"><a href="#cb51-233" aria-hidden="true" tabindex="-1"></a>    gdaab.ethnicity_black_or_african_american,</span>
<span id="cb51-234"><a href="#cb51-234" aria-hidden="true" tabindex="-1"></a>    eht.ethnicity_hispanic_or_latino</span>
<span id="cb51-235"><a href="#cb51-235" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaab</span>
<span id="cb51-236"><a href="#cb51-236" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> eth_hl_tab2 eht <span class="kw">on</span> (gdaab.person_uid <span class="op">=</span> eht.person_uid)</span>
<span id="cb51-237"><a href="#cb51-237" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-238"><a href="#cb51-238" aria-hidden="true" tabindex="-1"></a>gdaabhn <span class="kw">as</span> (</span>
<span id="cb51-239"><a href="#cb51-239" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(ent.person_uid, gdaabh.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-240"><a href="#cb51-240" aria-hidden="true" tabindex="-1"></a>    gdaabh.gender, </span>
<span id="cb51-241"><a href="#cb51-241" aria-hidden="true" tabindex="-1"></a>    gdaabh.date_of_birth, </span>
<span id="cb51-242"><a href="#cb51-242" aria-hidden="true" tabindex="-1"></a>    gdaabh.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-243"><a href="#cb51-243" aria-hidden="true" tabindex="-1"></a>    gdaabh.ethnicity_asian,</span>
<span id="cb51-244"><a href="#cb51-244" aria-hidden="true" tabindex="-1"></a>    gdaabh.ethnicity_black_or_african_american,</span>
<span id="cb51-245"><a href="#cb51-245" aria-hidden="true" tabindex="-1"></a>    gdaabh.ethnicity_hispanic_or_latino,</span>
<span id="cb51-246"><a href="#cb51-246" aria-hidden="true" tabindex="-1"></a>    ent.ethnicity_native_hawaiian_or_other_pacific_islander</span>
<span id="cb51-247"><a href="#cb51-247" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaabh</span>
<span id="cb51-248"><a href="#cb51-248" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> eth_nhpi_tab2 ent <span class="kw">on</span> (gdaabh.person_uid <span class="op">=</span> ent.person_uid)</span>
<span id="cb51-249"><a href="#cb51-249" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-250"><a href="#cb51-250" aria-hidden="true" tabindex="-1"></a>gdaabhnw <span class="kw">as</span> ( </span>
<span id="cb51-251"><a href="#cb51-251" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(ewt.person_uid, gdaabhn.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-252"><a href="#cb51-252" aria-hidden="true" tabindex="-1"></a>    gdaabhn.gender, </span>
<span id="cb51-253"><a href="#cb51-253" aria-hidden="true" tabindex="-1"></a>    gdaabhn.date_of_birth, </span>
<span id="cb51-254"><a href="#cb51-254" aria-hidden="true" tabindex="-1"></a>    gdaabhn.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-255"><a href="#cb51-255" aria-hidden="true" tabindex="-1"></a>    gdaabhn.ethnicity_asian,</span>
<span id="cb51-256"><a href="#cb51-256" aria-hidden="true" tabindex="-1"></a>    gdaabhn.ethnicity_black_or_african_american,</span>
<span id="cb51-257"><a href="#cb51-257" aria-hidden="true" tabindex="-1"></a>    gdaabhn.ethnicity_hispanic_or_latino,</span>
<span id="cb51-258"><a href="#cb51-258" aria-hidden="true" tabindex="-1"></a>    gdaabhn.ethnicity_native_hawaiian_or_other_pacific_islander,</span>
<span id="cb51-259"><a href="#cb51-259" aria-hidden="true" tabindex="-1"></a>    ewt.ethnicity_white</span>
<span id="cb51-260"><a href="#cb51-260" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaabhn</span>
<span id="cb51-261"><a href="#cb51-261" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> eth_white_tab2 ewt <span class="kw">on</span> (gdaabhn.person_uid <span class="op">=</span> ewt.person_uid)</span>
<span id="cb51-262"><a href="#cb51-262" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-263"><a href="#cb51-263" aria-hidden="true" tabindex="-1"></a>gdaabhnwo <span class="kw">as</span> ( </span>
<span id="cb51-264"><a href="#cb51-264" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(eot.person_uid, gdaabhnw.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-265"><a href="#cb51-265" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.gender, </span>
<span id="cb51-266"><a href="#cb51-266" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.date_of_birth, </span>
<span id="cb51-267"><a href="#cb51-267" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-268"><a href="#cb51-268" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_asian,</span>
<span id="cb51-269"><a href="#cb51-269" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_black_or_african_american,</span>
<span id="cb51-270"><a href="#cb51-270" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_hispanic_or_latino,</span>
<span id="cb51-271"><a href="#cb51-271" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_native_hawaiian_or_other_pacific_islander,</span>
<span id="cb51-272"><a href="#cb51-272" aria-hidden="true" tabindex="-1"></a>    gdaabhnw.ethnicity_white,</span>
<span id="cb51-273"><a href="#cb51-273" aria-hidden="true" tabindex="-1"></a>    eot.ethnicity_other</span>
<span id="cb51-274"><a href="#cb51-274" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaabhnw</span>
<span id="cb51-275"><a href="#cb51-275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> eth_other_tab2 eot <span class="kw">on</span> (gdaabhnw.person_uid <span class="op">=</span> eot.person_uid)</span>
<span id="cb51-276"><a href="#cb51-276" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-277"><a href="#cb51-277" aria-hidden="true" tabindex="-1"></a>all_comb <span class="kw">as</span> (</span>
<span id="cb51-278"><a href="#cb51-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> <span class="fu">coalesce</span>(up.person_uid, gdaabhnwo.person_uid) <span class="kw">as</span> person_uid, </span>
<span id="cb51-279"><a href="#cb51-279" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.gender, </span>
<span id="cb51-280"><a href="#cb51-280" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.date_of_birth, </span>
<span id="cb51-281"><a href="#cb51-281" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_american_indian_or_alaska_native,</span>
<span id="cb51-282"><a href="#cb51-282" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_asian,</span>
<span id="cb51-283"><a href="#cb51-283" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_black_or_african_american,</span>
<span id="cb51-284"><a href="#cb51-284" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_hispanic_or_latino,</span>
<span id="cb51-285"><a href="#cb51-285" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_native_hawaiian_or_other_pacific_islander,</span>
<span id="cb51-286"><a href="#cb51-286" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_white,</span>
<span id="cb51-287"><a href="#cb51-287" aria-hidden="true" tabindex="-1"></a>    gdaabhnwo.ethnicity_other</span>
<span id="cb51-288"><a href="#cb51-288" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> gdaabhnwo</span>
<span id="cb51-289"><a href="#cb51-289" aria-hidden="true" tabindex="-1"></a>    <span class="kw">full</span> <span class="kw">outer</span> <span class="kw">join</span> unique_ppl up <span class="kw">on</span> (gdaabhnwo.person_uid <span class="op">=</span> up.person_uid)</span>
<span id="cb51-290"><a href="#cb51-290" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-291"><a href="#cb51-291" aria-hidden="true" tabindex="-1"></a>get_key <span class="kw">as</span> (</span>
<span id="cb51-292"><a href="#cb51-292" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> mpm.person_master_id <span class="kw">as</span> person_key, all_comb.<span class="op">*</span> </span>
<span id="cb51-293"><a href="#cb51-293" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> all_comb </span>
<span id="cb51-294"><a href="#cb51-294" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> tr_e2e.mdm_person_master mpm <span class="kw">on</span> mpm.person_uid <span class="op">=</span> all_comb.person_uid</span>
<span id="cb51-295"><a href="#cb51-295" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-296"><a href="#cb51-296" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> get_key </span>
<span id="cb51-297"><a href="#cb51-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-298"><a href="#cb51-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-299"><a href="#cb51-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-300"><a href="#cb51-300" aria-hidden="true" tabindex="-1"></a><span class="co">--testing protocol - develop logic and test for someone with multiple non-missing values to make sure it works</span></span>
<span id="cb51-301"><a href="#cb51-301" aria-hidden="true" tabindex="-1"></a><span class="co">--example below </span></span>
<span id="cb51-302"><a href="#cb51-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-303"><a href="#cb51-303" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> f <span class="kw">as</span> (</span>
<span id="cb51-304"><a href="#cb51-304" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid, ethnicity_other, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt, </span>
<span id="cb51-305"><a href="#cb51-305" aria-hidden="true" tabindex="-1"></a>        <span class="co">--in ties of number of observations, order by INSERT VARIABLE </span></span>
<span id="cb51-306"><a href="#cb51-306" aria-hidden="true" tabindex="-1"></a>        <span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">by</span> person_uid <span class="kw">order</span> <span class="kw">by</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">desc</span>, </span>
<span id="cb51-307"><a href="#cb51-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">case</span> <span class="cf">when</span> ethnicity_other <span class="op">=</span> <span class="st">'2+'</span> <span class="cf">then</span> <span class="dv">1</span> </span>
<span id="cb51-308"><a href="#cb51-308" aria-hidden="true" tabindex="-1"></a>            <span class="cf">when</span> ethnicity_other <span class="op">=</span> <span class="st">'No'</span> <span class="cf">then</span> <span class="dv">2</span> </span>
<span id="cb51-309"><a href="#cb51-309" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="dv">3</span> <span class="cf">end</span></span>
<span id="cb51-310"><a href="#cb51-310" aria-hidden="true" tabindex="-1"></a>        ) <span class="kw">as</span> rn </span>
<span id="cb51-311"><a href="#cb51-311" aria-hidden="true" tabindex="-1"></a>    <span class="kw">from</span> tr_e2e.mdm_person_instance mpi </span>
<span id="cb51-312"><a href="#cb51-312" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> ethnicity_other <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'NC'</span>, <span class="st">'N/A'</span>)</span>
<span id="cb51-313"><a href="#cb51-313" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid, ethnicity_other</span>
<span id="cb51-314"><a href="#cb51-314" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb51-315"><a href="#cb51-315" aria-hidden="true" tabindex="-1"></a>dup <span class="kw">as</span> (</span>
<span id="cb51-316"><a href="#cb51-316" aria-hidden="true" tabindex="-1"></a>    <span class="kw">select</span> person_uid <span class="kw">from</span> tr_e2e.mdm_person_instance mpi <span class="kw">where</span> ethnicity_other <span class="kw">not</span> <span class="kw">in</span> (<span class="st">''</span>, <span class="st">'NC'</span>, <span class="st">'N/A'</span>)</span>
<span id="cb51-317"><a href="#cb51-317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">group</span> <span class="kw">by</span> person_uid <span class="kw">having</span> <span class="fu">count</span>(<span class="kw">distinct</span>(ethnicity_other)) <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb51-318"><a href="#cb51-318" aria-hidden="true" tabindex="-1"></a>    <span class="kw">limit</span> <span class="dv">1</span></span>
<span id="cb51-319"><a href="#cb51-319" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-320"><a href="#cb51-320" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> f <span class="kw">where</span> person_uid <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">distinct</span> person_uid <span class="kw">from</span> dup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="coleridge-initiative-adjustments" class="level3">
<h3 class="anchored" data-anchor-id="coleridge-initiative-adjustments">Coleridge Initiative Adjustments</h3>
<section id="new_fact_populate" class="level4">
<h4 class="anchored" data-anchor-id="new_fact_populate">new_fact_populate</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">distinct</span> person_key, program_key, entry_year_quarter_key, <span class="fu">max</span>(exit_year_quarter_key) <span class="kw">as</span> exit_year_quarter_key</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> tr_e2e.fact_person_program_participation fppp </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> program_key <span class="op">!=</span> <span class="dv">11</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> person_key, program_key, entry_year_quarter_key</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> person_key, program_key, entry_year_quarter_key </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="new_fact_table_creation" class="level4">
<h4 class="anchored" data-anchor-id="new_fact_table_creation">new_fact_table_creation</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">create</span> <span class="kw">table</span> <span class="cf">if</span> <span class="kw">not</span> <span class="kw">exists</span> tr_e2e.FACT_Person_Program_Start_End (</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>   Person_Program_Start_End_ID BIGINT <span class="kw">not</span> <span class="kw">null</span> identity,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>   Person_Key BIGINT <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>   Program_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>   Entry_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>   Exit_Year_Quarter_Key <span class="dt">INTEGER</span> <span class="kw">not</span> <span class="kw">null</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> PK_FACT_Person_Program_Start_End_IDX <span class="kw">primary</span> <span class="kw">key</span> (Person_Program_Start_End_ID),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">unique</span> (Person_Key, Program_Key, Entry_Year_Quarter_Key, Exit_Year_Quarter_Key),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_Program_Start_End_DIM_PROGRAM <span class="kw">foreign</span> <span class="kw">key</span> (Program_Key) </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> tr_e2e.DIM_Program (Program_Key),</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_Program_Start_End_DIM_YEAR_QUARTER_Entry <span class="kw">foreign</span> <span class="kw">key</span> (Entry_Year_Quarter_Key) </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> tr_e2e.DIM_Year_Quarter (Year_Quarter_Key),</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_Program_Start_End_DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> tr_e2e.DIM_Person (Person_Key),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>   <span class="kw">constraint</span> FK_FACT_PERSON_Program_Start_End_DIM_YEAR_QUARTER__EXIT_YEAR <span class="kw">foreign</span> <span class="kw">key</span> (Exit_Year_Quarter_Key) </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> tr_e2e.DIM_Year_Quarter (Year_Quarter_Key)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="kw">insert</span> <span class="kw">into</span> tr_e2e.fact_person_program_start_end( </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    person_key,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    program_key,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    entry_year_quarter_key,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    exit_year_quarter_key </span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="kw">distinct</span> person_key, program_key, entry_year_quarter_key, <span class="fu">max</span>(exit_year_quarter_key) <span class="kw">as</span> exit_year_quarter_key</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> tr_e2e.fact_person_program_participation fppp </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> program_key <span class="op">!=</span> <span class="dv">11</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> person_key, program_key, entry_year_quarter_key</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> person_key, program_key, entry_year_quarter_key </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">REFERENCES</span> <span class="kw">ON</span> <span class="kw">TABLE</span> tr_e2e.FACT_Person_Program_Start_End <span class="kw">TO</span> <span class="kw">group</span> ci_read_group;</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span>, <span class="kw">REFERENCES</span> <span class="kw">ON</span> <span class="kw">TABLE</span> tr_e2e.FACT_Person_Program_Start_End <span class="kw">TO</span> <span class="kw">group</span> db_t00113_rw;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="update_fks" class="level4">
<h4 class="anchored" data-anchor-id="update_fks">update_fks</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">alter</span> <span class="kw">table</span> tr_e2e.fact_person_ui_wage </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">add</span> <span class="kw">constraint</span> FK_FACT_PERSON_UI_WAGE__DIM_PERSON <span class="kw">foreign</span> <span class="kw">key</span> (Person_Key) </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">references</span> tr_e2e.DIM_Person (Person_Key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06_Presentation_prep.html" class="pagination-link" aria-label="Presentation Preparation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Presentation Preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./installing_packages.html" class="pagination-link" aria-label="Installing startup packages">
        <span class="nav-page-text"><span class="chapter-title">Installing startup packages</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>